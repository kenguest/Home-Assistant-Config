- id: '1608297533072'
  alias: Study heater off if study light off
  description: Turn off heater if study light is off
  trigger:
  - platform: state
    entity_id: light.study_light_level_on_off
    to: 'off'
    for:
      hours: 0
      minutes: 20
      seconds: 0
      milliseconds: 0
  condition: []
  action:
  - type: turn_off
    device_id: 5be0e5ccbdf92ad60895eb5792d7123b
    entity_id: switch.heater_study
    domain: switch
  mode: single
- id: '1608316207401'
  alias: Study light off at 13:00
  description: ''
  trigger:
  - platform: time
    at: '13:00'
  condition:
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  action:
  - type: turn_off
    device_id: 8cf7d4c4d3cfaa116c0ca88b1f13632b
    entity_id: light.study_light_level_on_off
    domain: light
  mode: single
- id: '1608641520746'
  alias: 'Dishwasher: Set active when power detected'
  trigger:
  - platform: numeric_state
    entity_id: sensor.switchdishwasher_smartenergy_metering
    above: '10'
  condition:
  - condition: or
    conditions:
    - condition: state
      entity_id: input_select.dishwasher_status
      state: Dirty
    - condition: state
      entity_id: input_select.dishwasher_status
      state: Clean
    - condition: state
      entity_id: input_select.dishwasher_status
      state: Drying
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.dishwasher_status
      option: Running
  mode: single
- id: '1608641520747'
  alias: 'Dishwasher: Set drying when power drops'
  trigger:
  - platform: numeric_state
    entity_id: sensor.switchdishwasher_smartenergy_metering
    below: '10'
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_select.dishwasher_status
      state: Running
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.dishwasher_status
      option: Drying
  mode: single
- id: '1608641520748'
  alias: 'Dishwasher: Set clean'
  trigger:
  - platform: state
    entity_id: input_select.dishwasher_status
    to: Drying
    for: 0:10:00
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_select.dishwasher_status
      state: Drying
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.dishwasher_status
      option: Clean
  mode: single
- id: '1608641520749'
  alias: 'Dishwasher: Set clean when power off'
  trigger:
  - platform: numeric_state
    entity_id: sensor.switchdishwasher_smartenergy_metering
    below: '2'
  condition:
  - condition: and
    conditions:
    - condition: numeric_state
      entity_id: sensor.switchdishwasher_smartenergy_metering
      below: '1'
    - condition: or
      conditions:
      - condition: state
        entity_id: input_select.dishwasher_status
        state: Clean
      - condition: state
        entity_id: input_select.dishwasher_status
        state: Drying
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.dishwasher_status
      option: Clean
  mode: single
- id: '1608641520750'
  alias: 'Tumble dryer: Send alert when finished'
  trigger:
  - platform: state
    for: 0:05:00
    entity_id: input_select.tumbledryer_status
    to: Finished
  condition: []
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: The tumble dryer has finished and is ready to be emptied!
      data:
        persistent: true
        tag: tumbledryer
        actions:
        - action: TUMBLE_DRYER_EMPTIED
          title: Mark tumbledryer emptied.
    enabled: true
  - service: automation.trigger
    target:
      entity_id: automation.announce_tumble_dryer_finished
    data:
      skip_condition: true
  - type: turn_off
    device_id: 0c8c3b79d94692008ba3e0fc927a553e
    entity_id: switch.plugtumble_dryer_on_off
    domain: switch
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.tumble_dryer_emptied
  mode: single
- id: '1610534431581'
  alias: When Ken comes home turn on lights
  description: ''
  trigger:
  - platform: zone
    entity_id: person.ken_guest
    zone: zone.home
    event: enter
  condition: []
  action:
  - domain: light
    entity_id: light.hall_light
    device_id: 7ab073c9430e868c28fcb943989e68d9
    type: turn_on
  - service: notify.notify_via_pushbullet
    data:
      message: Welcome home Ken!
      target: email/ken.guest@gmail.com
  - service: notify.mobile_app_kens_phone
    data:
      message: Welcome home Ken!
  - service: automation.turn_off
    data: {}
    entity_id: automation.turn_on_lights_when_i_come_home
  mode: single
- id: '1610648558807'
  alias: When we are away turn off the heaters
  description: ''
  triggers:
  - entity_id: person.aisling
    zone: zone.home
    event: leave
    trigger: zone
  - entity_id: person.ken_guest
    zone: zone.home
    event: leave
    trigger: zone
  conditions:
  - condition: and
    conditions:
    - condition: state
      entity_id: person.ken_guest
      state: not_home
    - condition: state
      state: not_home
      entity_id: person.aisling
  actions:
  - type: turn_off
    device_id: 9bd5db4e258fb399874a670f894fedfc
    entity_id: switch.heater_master_bedroom
    domain: switch
  - type: turn_off
    device_id: 5be0e5ccbdf92ad60895eb5792d7123b
    entity_id: switch.heater_study
    domain: switch
  - type: turn_off
    device_id: 7905e40094c3ea0f6db679b26ad4791e
    entity_id: switch.tz3000_00mk2xzy_ts011f_d04c09fe_on_off
    domain: switch
  - action: climate.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: climate.master_bedroom
  mode: single
- id: '1611335214798'
  alias: 'Bedroom heater: on  for lunch time if too cold'
  description: ''
  trigger:
  - platform: time
    at: '12:30:00'
  condition:
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  - condition: numeric_state
    entity_id: sensor.masterbedroom_temperature
    attribute: temperature
    below: '15'
  action:
  - type: turn_on
    device_id: 9bd5db4e258fb399874a670f894fedfc
    entity_id: switch.heater_master_bedroom
    domain: switch
  mode: single
- id: '1611700754940'
  alias: Hot water - turn off after 30 minutes
  description: Turn off the Hive water heater after 30 mins use
  trigger:
  - platform: state
    entity_id: water_heater.hotwater
    attribute: operation_mode
    from: 'off'
    to: 'on'
    for: 0:30:00
  condition: []
  action:
  - service: water_heater.set_operation_mode
    data:
      entity_id: water_heater.hotwater
      operation_mode: 'off'
    entity_id: water_heater.hotwater
  - service: notify.mobile_app_kens_phone
    data:
      message: The hot water has been on for 30 minutes. Switching off
  - service: input_datetime.set_datetime
    data:
      datetime: '{{ now().strftime(''%Y-%m-%d %H:%M:%S'') }}'
    target:
      entity_id: input_datetime.hot_water_datetime
  mode: single
- id: '1612046712949'
  alias: 'Dishwasher: Consume tablet if running'
  description: ''
  trigger:
  - platform: state
    entity_id: input_select.dishwasher_status
    to: Running
  condition: []
  action:
  - service: shell_command.grocy_consume_item
    data:
      server_ip: 127.0.0.1
      grocy_key: psTNW1jpsaF3MIU7cIXzVumAtmdXSEzViQagpXLnonVdgnQ44f
      product_id: 23
      amount: 1
  - service: automation.turn_off
    data: {}
    entity_id: automation.dishwasher_consume_tablet_if_running
  mode: single
- id: '1612697537130'
  alias: Kettle - on for hot water bottle
  description: ''
  triggers:
  - type: turned_on
    device_id: b846ad89f41bd9f920420f54ebbb49c6
    entity_id: switch.tz3000_00mk2xzy_ts011f_on_off
    domain: switch
    for:
      hours: 0
      minutes: 3
      seconds: 0
    trigger: device
  conditions: []
  actions:
  - type: turn_off
    device_id: b846ad89f41bd9f920420f54ebbb49c6
    entity_id: switch.tz3000_00mk2xzy_ts011f_on_off
    domain: switch
  - target:
      entity_id: automation.announce_hot_water_bottle_ready
    data: {}
    action: automation.trigger
  - data: {}
    entity_id: automation.kettle_turn_off_after_4_minutes
    action: automation.turn_off
  mode: single
- id: '1613215949927'
  alias: 'System: Reconnect Fritzbox'
  description: ''
  trigger:
  - platform: time
    at: 04:00:00
  condition: []
  action:
  - service: button.press
    metadata: {}
    data: {}
    target:
      entity_id:
      - button.fritz_box_7530_reconnect_2
  mode: single
- id: '1613470132446'
  alias: Study door opens
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 722b620d26bd7ce8a669d56d9f43ba0a
    entity_id: binary_sensor.lumi_lumi_sensor_magnet_aq2_on_off
    domain: binary_sensor
    for:
      hours: 0
      minutes: 0
      seconds: 0
  condition:
  - condition: state
    entity_id: sun.sun
    state: below_horizon
  action:
  - type: toggle
    device_id: 8cf7d4c4d3cfaa116c0ca88b1f13632b
    entity_id: 51d68a415ccd72aecae349e858995853
    domain: light
  - service: input_select.select_option
    data:
      option: door
    target:
      entity_id: input_select.input_select_study_light_actuator
  mode: single
- id: '1613563604387'
  alias: Living room door opens
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: daac5fc4ff17348df26ff34fbd47b9f9
    entity_id: binary_sensor.lumi_lumi_sensor_magnet_aq2_e1b7e401_on_off
    domain: binary_sensor
  condition: []
  action:
  - type: toggle
    device_id: 059a6332697d8410b28702ada3261960
    entity_id: light.living_room_light
    domain: light
  mode: single
- id: '1613602457585'
  alias: Master bedroom door opens
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 3a16a30d024926e21f850edf9dfa7daf
    entity_id: binary_sensor.lumi_lumi_sensor_magnet_aq2_4bd3e401_on_off
    domain: binary_sensor
  condition:
  - condition: state
    entity_id: input_select.home_mode_status
    state: Alone
  action:
  - type: toggle
    device_id: bd07dedaabba965fc86b376e3773d12c
    entity_id: switch.bedside_lamp
    domain: switch
  mode: single
- id: '1613692470498'
  alias: 'Washing machine: active when power detected'
  trigger:
  - platform: numeric_state
    above: '10'
    entity_id: sensor.plugwashing_machine_electrical_measurement
  condition:
  - condition: or
    conditions:
    - condition: state
      entity_id: sensor.washing_machine_status
      state: Idle
    - condition: state
      entity_id: sensor.washing_machine_status
      state: Clean
    - condition: state
      entity_id: sensor.washing_machine_status
      state: Finishing
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.washing_machine_status
      option: Running
  mode: single
- id: '1613692470499'
  alias: 'Washing machine: finished when power drops'
  trigger:
  - platform: numeric_state
    entity_id: sensor.plugwashing_machine_electrical_measurement
    below: '6'
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_select.washing_machine_status
      state: Running
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.washing_machine_status
      option: Finishing
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.washing_machine_emptied
  mode: single
- id: '1614692470499'
  alias: 'Washing machine: clean after timeout'
  trigger:
  - platform: state
    entity_id: input_select.washing_machine_status
    to: Finishing
    for: 0:08:00
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_select.washing_machine_status
      state: Finishing
  action:
  - service: input_select.select_option
    data:
      entity_id: input_select.washing_machine_status
      option: Clean
  mode: single
- id: '1613692470491'
  alias: 'Washing machine: Send alert when finished'
  trigger:
  - platform: state
    entity_id:
    - sensor.washing_machine_status
    to: Clean
    for:
      hours: 0
      minutes: 1
      seconds: 0
    from: Finishing
  condition: []
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: Hey, the washing machine has finished and is ready to be emptied
      data:
        persistent: true
        tag: washing
        actions:
        - action: WASHING_MACHINE_EMPTIED
          title: It's done
  - if:
    - type: is_occupied
      condition: device
      device_id: eccd4be440829370bbd78ad4adfc828f
      entity_id: c29f63f421873dc7c05eb93b395434d7
      domain: binary_sensor
    then:
    - service: media_player.play_media
      target:
        entity_id:
        - media_player.office
        - media_player.tramexkwg
      data:
        media_content_id: http://192.168.178.31:8123/local/recordings/washingMachineFinished.mp3
        media_content_type: music
  mode: single
- id: '1614848795158'
  alias: 'Car kit: when connected enable automation re coming home'
  description: ''
  trigger:
  - platform: state
    entity_id: sensor.kens_phone_bluetooth_connection
    attribute: connected_paired_devices
    to: '[DC:9B:EB:E6:A9:49]'
  condition: []
  action:
  - service: automation.turn_on
    target:
      entity_id: automation.turn_on_lights_when_i_come_home
  mode: single
- id: '1615244774648'
  alias: Egg cooker
  description: ''
  trigger:
  - platform: device
    type: turned_on
    device_id: b846ad89f41bd9f920420f54ebbb49c6
    entity_id: switch.tz3000_00mk2xzy_ts011f_on_off
    domain: switch
    for:
      hours: 0
      minutes: 13
      seconds: 0
      milliseconds: 0
  condition: []
  action:
  - type: turn_off
    device_id: b846ad89f41bd9f920420f54ebbb49c6
    entity_id: switch.tz3000_00mk2xzy_ts011f_on_off
    domain: switch
  - service: automation.turn_off
    data: {}
    target:
      entity_id: automation.egg_boiler
  - service: notify.mobile_app_kens_phone
    data:
      message: TTS
      data:
        priority: high
        tts_text: Listen up. The egg cooker has finished.
        channel: alarm_stream
  - service: notify.mobile_app_kens_phone
    data:
      message: The egg cooker has finished
  mode: single
- id: '1616093952307'
  alias: Cloak room door opens and light is off
  description: ''
  trigger:
  - platform: state
    from: 'off'
    to: 'on'
    entity_id: binary_sensor.lumi_lumi_sensor_magnet_aq2_a9c35302_on_off
  condition:
  - condition: state
    entity_id: light.cloak_room
    state: 'off'
  action:
  - type: turn_on
    device_id: 56c4719e543e20c7f933d79e3a1a3b87
    entity_id: 272c8de48e8d872bac868e852d6d6157
    domain: light
  mode: single
- id: '1616094003846'
  alias: Laundry room door closes
  description: ''
  trigger:
  - platform: state
    from: 'on'
    to: 'off'
    entity_id: binary_sensor.lumi_lumi_sensor_magnet_aq2_a9c35302_on_off
  condition: []
  action:
  - type: toggle
    device_id: 56c4719e543e20c7f933d79e3a1a3b87
    entity_id: light.cloak_room
    domain: light
  mode: single
- id: '1616502001922'
  alias: Hall light on from 7-8am mo-fr
  description: ''
  trigger:
  - platform: time
    at: 07:00
  condition:
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: '''on'''
  action:
  - type: turn_on
    device_id: 7ab073c9430e868c28fcb943989e68d9
    entity_id: light.hall_light
    domain: light
    brightness_pct: 100
  - service: automation.turn_off
    target:
      entity_id: automation.master_bedroom_door_opens
  mode: single
- id: '1616502002853'
  alias: Leave hall light on from 7-8am mo-fr
  description: ''
  trigger:
  - platform: time
    at: 07:00
  condition:
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: '''on'''
  action:
  - type: turn_on
    device_id: 7ab073c9430e868c28fcb943989e68d9
    entity_id: light.hall_light
    domain: light
    brightness_pct: 100
  - service: automation.turn_off
    target:
      entity_id: automation.master_bedroom_door_opens
  mode: single
- id: '1617219746837'
  alias: Hall light on when hall sensor detects motion
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.hall_sensor_motion
    to: 'on'
  condition:
  - condition: numeric_state
    entity_id: sensor.hall_sensor_illuminance
    below: 45
  action:
  - domain: light
    entity_id: light.hall_light
    device_id: 7ab073c9430e868c28fcb943989e68d9
    type: turn_on
    brightness_pct: 100
  - service: input_select.select_option
    target:
      entity_id: input_select.home_mode_status
    data:
      option: Normal
  mode: single
- id: '1617221340992'
  alias: 'Hall light: Off when no motion'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.hall_sensor_occupancy
    to: 'off'
  condition:
  - condition: time
    after: 09:00:00
  action:
  - type: turn_off
    device_id: 7ab073c9430e868c28fcb943989e68d9
    entity_id: light.hall_light
    domain: light
  mode: single
- id: '1617479629941'
  alias: Kitchen lights off when not occupied
  description: ''
  trigger:
  - type: not_occupied
    platform: device
    device_id: 29007fde37da4738c0b1e1fa0c8261ec
    entity_id: binary_sensor.kitchen_sensor_occupancy
    domain: binary_sensor
  condition: []
  action:
  - type: turn_off
    device_id: cf7a4ae6da4fbff3b5b2fea8d4fbf8a2
    entity_id: light.back_kitchen_light
    domain: light
  - type: turn_off
    device_id: 3f95f5b29214187c4df9e8a746b587b0
    entity_id: light.front_kitchen_light
    domain: light
  mode: single
- id: '1617479630774'
  alias: 'Kitchen lights: turn on when motion detected'
  description: ''
  trigger:
  - type: motion
    platform: device
    device_id: 29007fde37da4738c0b1e1fa0c8261ec
    entity_id: binary_sensor.kitchen_sensor_motion_ias_zone
    domain: binary_sensor
  condition:
  - type: is_illuminance
    condition: device
    device_id: 29007fde37da4738c0b1e1fa0c8261ec
    entity_id: sensor.kitchen_sensor_illuminance
    domain: sensor
    below: 25
  action:
  - type: turn_on
    device_id: 3f95f5b29214187c4df9e8a746b587b0
    entity_id: light.front_kitchen_light
    domain: light
  - type: turn_on
    device_id: cf7a4ae6da4fbff3b5b2fea8d4fbf8a2
    entity_id: light.back_kitchen_light
    domain: light
  - service: input_select.select_option
    target:
      entity_id: input_select.home_mode_status
    data:
      option: Normal
  mode: single
- id: '1617661102611'
  alias: 'Top Platform Sensor: motion turns on'
  description: ''
  trigger:
  - type: motion
    platform: device
    device_id: f8835a0621ca201abdb9634e8d71c0a7
    entity_id: binary_sensor.top_platform_ias_zone
    domain: binary_sensor
  condition:
  - condition: state
    entity_id: sun.sun
    state: below_horizon
  action:
  - type: turn_on
    device_id: dad6ed559cf6187b8db1b104129fe92f
    entity_id: 4967f68fd2ca739e62b3a5a4acc8275e
    domain: light
    brightness_pct: 100
  - service: input_select.select_option
    target:
      entity_id: input_select.home_mode_status
    data:
      option: Normal
  mode: single
- id: '1617661278552'
  alias: 'Top Platform sensor: no motion turns off landing light'
  description: When motion is no longer detected, turn off the top landing light
  triggers:
  - type: no_motion
    device_id: f8835a0621ca201abdb9634e8d71c0a7
    entity_id: binary_sensor.top_platform_ias_zone
    domain: binary_sensor
    for:
      hours: 0
      minutes: 5
      seconds: 0
    trigger: device
  conditions: []
  actions:
  - type: turn_off
    device_id: dad6ed559cf6187b8db1b104129fe92f
    entity_id: 4967f68fd2ca739e62b3a5a4acc8275e
    domain: light
  mode: single
- id: '1617661279405'
  alias: 'Top landing sensor: no motion turns off'
  description: ''
  trigger:
  - type: no_motion
    platform: device
    device_id: 22eabfcd41c120a04b2ddbe2f39fadaf
    entity_id: d294e9dcb4d259be4e036ff4b94461dd
    domain: binary_sensor
  condition: []
  action:
  - type: turn_off
    device_id: 4cde3872053b4b4e470b84c28985d8f0
    entity_id: light.top_landing_light
    domain: light
  mode: single
- id: '1617711109258'
  alias: Laundry room light on if door open
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 3f4c112fa93769c42d251fa0dea7d90b
    entity_id: binary_sensor.door_laundry_room_on_off
    domain: binary_sensor
  condition: []
  action:
  - type: turn_on
    device_id: 8a1b10ca703ccf23f5477e8c44a20c37
    entity_id: light.laundry_room_light
    domain: light
    brightness_pct: 100
  mode: single
- id: '1617711288932'
  alias: Laundry room door opens
  description: ''
  trigger:
  - type: not_opened
    platform: device
    device_id: 3f4c112fa93769c42d251fa0dea7d90b
    entity_id: binary_sensor.door_laundry_room_on_off
    domain: binary_sensor
  condition: []
  action:
  - type: turn_off
    device_id: 8a1b10ca703ccf23f5477e8c44a20c37
    entity_id: light.laundry_room_light
    domain: light
  mode: single
- id: '1617742795078'
  alias: 'Top landing sensor: Motion turns on'
  description: ''
  trigger:
  - type: motion
    platform: device
    device_id: 22eabfcd41c120a04b2ddbe2f39fadaf
    entity_id: d294e9dcb4d259be4e036ff4b94461dd
    domain: binary_sensor
  condition:
  - type: is_illuminance
    condition: device
    device_id: 22eabfcd41c120a04b2ddbe2f39fadaf
    entity_id: 965d518397470d2875c87818f3bb221f
    domain: sensor
    below: 40
  action:
  - type: turn_on
    device_id: 4cde3872053b4b4e470b84c28985d8f0
    entity_id: light.top_landing_light
    domain: light
    brightness_pct: 100
  - service: input_select.select_option
    target:
      entity_id: input_select.home_mode_status
    data:
      option: Normal
  mode: single
- id: '1618179500569'
  alias: 'Study: Get ready for work'
  description: Turn on everything at desk
  trigger:
  - platform: time
    at: 07:55
  condition:
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  action:
  - type: turn_on
    device_id: e9453ffdcd0ebf1d4f8d3207d4244866
    entity_id: switch.laptop_charger
    domain: switch
  - type: turn_on
    device_id: e9453ffdcd0ebf1d4f8d3207d4244866
    entity_id: switch.tz3000_vmpbygs5_ts011f_ab5c4ffe_on_off_3
    domain: switch
  - type: turn_on
    device_id: e9453ffdcd0ebf1d4f8d3207d4244866
    entity_id: switch.tz3000_vmpbygs5_ts011f_ab5c4ffe_on_off_2
    domain: switch
  mode: single
- id: '1618232556073'
  alias: Guest bedroom door opens
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: e6b24c1897da6a8079cfea21cb45fd8b
    entity_id: binary_sensor.door_guest_bedroom
    domain: binary_sensor
  condition: []
  action:
  - type: toggle
    device_id: 1488e909e7ade45f02d81f77eebb5721
    entity_id: light.guest_room
    domain: light
  mode: single
- id: '1618779495911'
  alias: 'Tumble dryer : Set to drying'
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: sensor.plugtumble_dryer_smartenergy_metering
    above: '1000'
  condition: []
  action:
  - service: input_select.select_option
    target:
      entity_id: input_select.tumbledryer_status
    data:
      option: Drying
  mode: single
- id: '1618780327802'
  alias: 'Tumble dryer : finished'
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: sensor.plugtumble_dryer_smartenergy_metering
    below: '10'
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_select.tumbledryer_status
      state: Tumbling
  action:
  - service: input_select.select_option
    target:
      entity_id: input_select.tumbledryer_status
    data:
      option: Finished
  mode: single
- id: '1618781323787'
  alias: 'Tumble dryer : tumbling'
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: sensor.plugtumble_dryer_smartenergy_metering
    above: '15'
    below: '500'
  condition: []
  action:
  - service: input_select.select_option
    target:
      entity_id: input_select.tumbledryer_status
    data:
      option: Tumbling
  mode: single
- id: '1618907757073'
  alias: 'Dishwasher: Send alert when finished'
  description: ''
  trigger:
  - platform: state
    for: 0:10:00
    entity_id: input_select.dishwasher_status
    to: Clean
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: input_select.dishwasher_status
      state: Clean
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: The dishwasher has finished and is ready to be emptied!
      data:
        persistent: true
        tag: dishwasher
        actions:
        - action: DISHWASHER_EMPTIED
          title: Confirm dishwasher emptied.
  - service: automation.turn_on
    data: {}
    entity_id: automation.dishwasher_consume_tablet_if_running
  - service: automation.turn_on
    target:
      entity_id: automation.announce_dishwasher_finished
    data: {}
  - type: turn_off
    device_id: 8f9eb20202baf76e6cbdbdcf86cae4b8
    entity_id: switch.switchdishwasher_on_off
    domain: switch
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.dishwasher_emptied
  mode: single
- id: '1620768476628'
  alias: 'Top landing sensor: Send alert if offline'
  description: ''
  trigger:
  - device_id: 22eabfcd41c120a04b2ddbe2f39fadaf
    domain: zha
    platform: device
    type: device_offline
    subtype: device_offline
  condition: []
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: top landing sensor is offline
  mode: single
- id: '1621811372182'
  alias: Bed time
  description: Turn off everything apart from lights in master bedroom
  trigger:
  - platform: state
    entity_id:
    - input_select.home_mode_status
    to: Bed time
    for:
      hours: 0
      minutes: 0
      seconds: 0
  condition: []
  action:
  - service: light.turn_off
    target:
      entity_id: light.all_lights
    data: {}
  - type: turn_off
    device_id: 7905e40094c3ea0f6db679b26ad4791e
    entity_id: switch.heater_guest_bedroom
    domain: switch
  - type: turn_off
    device_id: e9453ffdcd0ebf1d4f8d3207d4244866
    entity_id: switch.tz3000_vmpbygs5_ts011f_ab5c4ffe_on_off_3
    domain: switch
  - type: turn_off
    device_id: e9453ffdcd0ebf1d4f8d3207d4244866
    entity_id: switch.tz3000_vmpbygs5_ts011f_ab5c4ffe_on_off_2
    domain: switch
  - service: input_select.select_option
    target:
      entity_id: input_select.voice_announcements_status
    data:
      option: Disabled
  - service: automation.turn_off
    data:
      stop_actions: true
    target:
      entity_id: automation.kitchen_turn_on_hall_light_when_hall_sekitnsor_detects_motion_duplicate_2
  - service: counter.reset
    data: {}
    target:
      entity_id: counter.ken_daily_alarm_count
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.front_door_light
  mode: single
- id: '1621811784863'
  alias: Reset home mode
  description: ''
  trigger:
  - platform: sun
    event: sunrise
  condition: []
  action:
  - service: input_select.select_option
    target:
      entity_id: input_select.home_mode_status
    data:
      option: Normal
  mode: single
- id: '1622200616279'
  alias: Landing light on when sensor detects motion
  description: ''
  trigger:
  - type: motion
    platform: device
    device_id: 5cb929bb135e3cedf31510218bba30d4
    entity_id: binary_sensor.landing_sensor_ias_zone
    domain: binary_sensor
  condition:
  - type: is_illuminance
    condition: device
    device_id: 5cb929bb135e3cedf31510218bba30d4
    entity_id: 30b6768366dcac4872de6a0fa5d0e5a3
    domain: sensor
    below: 45
  action:
  - type: turn_on
    device_id: dad6ed559cf6187b8db1b104129fe92f
    entity_id: 4967f68fd2ca739e62b3a5a4acc8275e
    domain: light
  - service: input_select.select_option
    target:
      entity_id: input_select.home_mode_status
    data:
      option: Normal
  mode: single
- id: '1622204734627'
  alias: 'Landing light: Off when no motion'
  description: ''
  trigger:
  - type: no_motion
    platform: device
    device_id: 5cb929bb135e3cedf31510218bba30d4
    entity_id: binary_sensor.landing_sensor_ias_zone
    domain: binary_sensor
  condition: []
  action:
  - type: turn_off
    device_id: dad6ed559cf6187b8db1b104129fe92f
    entity_id: 4967f68fd2ca739e62b3a5a4acc8275e
    domain: light
  mode: single
- id: '1622204735635'
  alias: 'Landing light: Off when no motion'
  description: ''
  trigger:
  - type: no_motion
    platform: device
    device_id: 5cb929bb135e3cedf31510218bba30d4
    entity_id: binary_sensor.landing_sensor_motion
    domain: binary_sensor
  condition: []
  action:
  - type: turn_off
    device_id: dad6ed559cf6187b8db1b104129fe92f
    entity_id: 4967f68fd2ca739e62b3a5a4acc8275e
    domain: light
  mode: single
- id: '1626564873518'
  alias: Fan for 30 minutes
  description: ''
  trigger:
  - platform: device
    type: turned_on
    device_id: 7905e40094c3ea0f6db679b26ad4791e
    entity_id: switch.tz3000_00mk2xzy_ts011f_d04c09fe_on_off
    domain: switch
    for:
      hours: 0
      minutes: 30
      seconds: 30
      milliseconds: 0
  condition: []
  action:
  - type: turn_off
    device_id: 7905e40094c3ea0f6db679b26ad4791e
    entity_id: switch.tz3000_00mk2xzy_ts011f_d04c09fe_on_off
    domain: switch
  mode: single
- id: '1628586228870'
  alias: Livingroom IKEA Controller
  description: ''
  use_blueprint:
    path: frenck/zha-ikea-five-button-remote-for-lights.yaml
    input:
      remote: fb4fd0ba43df19d99940ab88c37d11eb
      light:
        area_id: living_room
        entity_id: light.living_room_light
- id: '1628630296330'
  alias: Guest Bedroom remote
  description: ''
  use_blueprint:
    path: frenck/zha-ikea-five-button-remote-for-lights.yaml
    input:
      remote: ab80ad1ec8d9b0d8a949c4ef5ff87fbb
      brightness: 100
      force_brightness: false
      button_left_long:
      - type: turn_off
        device_id: 1488e909e7ade45f02d81f77eebb5721
        entity_id: 72268b416970bab42a142fc7ae7026a4
        domain: light
      button_left_short:
      - type: turn_off
        device_id: 1488e909e7ade45f02d81f77eebb5721
        entity_id: 72268b416970bab42a142fc7ae7026a4
        domain: light
      button_right_short:
      - type: turn_off
        device_id: 1488e909e7ade45f02d81f77eebb5721
        entity_id: 72268b416970bab42a142fc7ae7026a4
        domain: light
      button_right_long:
      - type: turn_off
        device_id: 1488e909e7ade45f02d81f77eebb5721
        entity_id: 72268b416970bab42a142fc7ae7026a4
        domain: light
      light:
        device_id: 1488e909e7ade45f02d81f77eebb5721
- id: '1630275244096'
  alias: 'Announce: Dishwasher finished'
  description: ''
  trigger: []
  condition:
  - condition: state
    entity_id: input_select.voice_announcements_status
    state: Enabled
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: The dishwasher has finished and is ready to be emptied
  - service: media_player.play_media
    target:
      entity_id: media_player.office
    data:
      media_content_id: media-source://tts/google_translate?message=Hey+-+the+dishwasher+is+finished+and+can+be+emptied+now.&language=en-ie
      media_content_type: provider
    metadata:
      title: Hey - the dishwasher is finished and can be emptied now.
      thumbnail: https://brands.home-assistant.io/_/google_translate/logo.png
      media_class: app
      children_media_class:
      navigateIds:
      - {}
      - media_content_type: app
        media_content_id: media-source://tts
      - media_content_type: provider
        media_content_id: media-source://tts/google_translate?message=Hey+-+the+dishwasher+is+finished+and+can+be+emptied+now.&language=en-ie
  mode: single
- id: '1630275244097'
  alias: 'Announce: Tumble dryer finished'
  description: ''
  trigger: []
  condition:
  - condition: zone
    entity_id: person.ken_guest
    zone: zone.home
  - condition: state
    entity_id: binary_sensor.tramexkwg_meeting
    state: 'off'
  - condition: state
    entity_id: input_select.voice_announcements_status
    state: Enabled
  action:
  - data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: Hey, the tumble dryer has finished and is ready to be emptied
    action: notify.mobile_app_kens_phone
  mode: single
- id: '1630277358628'
  alias: Reset voice mode
  description: ''
  trigger:
  - platform: sun
    event: sunrise
  condition: []
  action:
  - service: input_select.select_option
    target:
      entity_id: input_select.voice_announcements_status
    data:
      option: Enabled
  mode: single
- id: '1630277729074'
  alias: 'Announce: hot water bottle ready'
  description: ''
  trigger: []
  condition:
  - condition: state
    entity_id: input_select.voice_announcements_status
    state: Enabled
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: Water is hot enough for the hot water bottle
  - service: media_player.play_media
    target:
      entity_id: media_player.office
    data:
      media_content_id: media-source://tts/google_translate?message=Hey%2C+water+is+done+for+the+hot+water+bottle
      media_content_type: provider
    metadata:
      title: Hey, water is done for the hot water bottle
      thumbnail: https://brands.home-assistant.io/_/google_translate/logo.png
      media_class: app
      children_media_class:
      navigateIds:
      - {}
      - media_content_type: app
        media_content_id: media-source://tts
      - media_content_type: provider
        media_content_id: media-source://tts/google_translate?message=Hey%2C+water+is+done+for+the+hot+water+bottle
  mode: single
- id: '1630361668922'
  alias: 'Bluetooth: no headphones connected'
  description: ''
  trigger:
  - platform: state
    entity_id: sensor.kens_phone_bluetooth_connection
    attribute: connected_paired_devices
    to: '[]'
  condition: []
  action:
  - service: input_select.select_option
    target:
      entity_id: input_select.voice_announcements_status
    data:
      option: Enabled
  mode: single
- id: '1630363079359'
  alias: 'Bluetooth: Ken''s Odio headphones connect'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.kens_phone_bluetooth_connection
    attribute: connected_paired_devices
    to: '"04:29:2E:DD:31:5F (Galaxy Watch5 (XSGM)), 88:08:94:01:F2:7B (Hesh ANC)"'
  condition: []
  action:
  - service: input_select.select_option
    target:
      entity_id: input_select.voice_announcements_status
    data:
      option: Disabled
  mode: single
- id: '1631479475288'
  alias: When robovac starts cleaning
  description: ''
  trigger:
  - platform: state
    entity_id:
    - vacuum.robovac
    to: cleaning
    for:
      hours: 0
      minutes: 0
      seconds: 30
    from: docked
  condition: []
  action:
  - service: counter.increment
    target:
      entity_id: counter.robovac_usage
    data: {}
  - service: automation.trigger
    target:
      entity_id: automation.announce_robovac_has_started
    data:
      skip_condition: true
    enabled: false
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.robovac_cleaning
  mode: single
- id: '1631994672786'
  alias: Turn off downstairs heating at night
  description: ''
  trigger:
  - platform: time
    at: '22:05'
  condition: []
  action:
  - service: climate.set_temperature
    data:
      temperature: 7
      hvac_mode: 'off'
    target:
      entity_id: climate.downstairs
  mode: single
- id: '1631995584070'
  alias: Turn off upstairs heating at night
  description: ''
  trigger:
  - platform: time
    at: '23:01:00'
  condition: []
  action:
  - service: climate.turn_off
    target:
      entity_id: climate.upstairs
    data: {}
  mode: single
- id: '1632774922435'
  alias: 'Announce: Robovac has started'
  description: ''
  trigger: []
  condition:
  - condition: state
    entity_id: input_select.voice_announcements_status
    state: Enabled
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: The robovack has started
  - service: notify.mobile_app_aisling_s_phone
    data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: The robovack has started
  mode: single
- id: '1633443631366'
  alias: 'Announce: Robovac has finished'
  description: ''
  trigger: []
  condition:
  - condition: state
    entity_id: input_select.voice_announcements_status
    state: Enabled
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: The robovack has finished
  - service: notify.mobile_app_aisling_s_phone
    data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: The robovack has finished
  mode: single
- id: '1633443769746'
  alias: 'RoboVac: Detect returned to dock'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - vacuum.robovac
    for:
      hours: 0
      minutes: 0
      seconds: 0
    to: docked
    from:
  condition: []
  action:
  - if:
    - condition: state
      entity_id: input_boolean.robovac_cleaning
      state: 'on'
    then:
    - service: automation.trigger
      target:
        entity_id: automation.announce_robovac_has_finished
      data:
        skip_condition: true
    enabled: false
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.robovac_cleaning
  mode: single
- id: '1634844322650'
  alias: Cats light on when sensor detects motion
  description: ''
  trigger:
  - type: motion
    platform: device
    device_id: 1ed2e45bc1ad583d351491e91fc204ad
    entity_id: binary_sensor.cats_sensor_motion
    domain: binary_sensor
  condition:
  - type: is_illuminance
    condition: device
    device_id: 1ed2e45bc1ad583d351491e91fc204ad
    entity_id: sensor.cats_sensor_illuminance
    domain: sensor
    below: 45
  action:
  - target:
      entity_id: input_select.home_mode_status
    data:
      option: Normal
    enabled: false
    action: input_select.select_option
  - action: light.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: light.cats_room
  mode: single
- id: '1634849756725'
  alias: 'Cat sensor: no motion turns off'
  description: ''
  trigger:
  - type: no_motion
    platform: device
    device_id: 1ed2e45bc1ad583d351491e91fc204ad
    entity_id: binary_sensor.cats_sensor_motion
    domain: binary_sensor
    for:
      hours: 0
      minutes: 5
      seconds: 0
  condition: []
  action:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: light.cats_room
  mode: single
- id: '1637143602410'
  alias: Disable study door automation if phone is charging wirelessly
  description: ''
  trigger:
  - platform: state
    entity_id: sensor.kens_phone_charger_type
    to: wireless
  condition: []
  action:
  - service: automation.turn_off
    target:
      entity_id: automation.new_automation_3
  mode: single
- id: '1637143885464'
  alias: Disable study door automation if phone is  not charging wirelessly
  description: ''
  trigger:
  - platform: state
    entity_id: sensor.kens_phone_charger_type
    to: none
    from: wireless
  condition: []
  action:
  - service: automation.turn_on
    target:
      entity_id: automation.new_automation_3
  mode: single
- id: '1657061102274'
  alias: Home Mode changes to Normal
  description: Reenable kitchen motion automation etc
  trigger:
  - platform: state
    entity_id:
    - input_select.home_mode_status
    to: Normal
    for:
      hours: 0
      minutes: 0
      seconds: 2
  condition: []
  action:
  - service: input_select.select_option
    target:
      entity_id: input_select.voice_announcements_status
    data:
      option: Enabled
  - service: automation.turn_on
    data: {}
    target:
      entity_id: automation.kitchen_turn_on_hall_light_when_hall_sekitnsor_detects_motion_duplicate_2
  mode: single
- id: '1657313957003'
  alias: 'Washing machine: Turn off when clean for 30 minutes'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.washing_machine_status
    to: Clean
    for:
      hours: 0
      minutes: 30
      seconds: 0
  condition: []
  action:
  - service: switch.turn_off
    data: {}
    target:
      entity_id: switch.plugwashing_machine_on_off
  mode: single
- id: '1658342133585'
  alias: Hot water - notify when on
  description: Notify when hot water is switched on
  trigger:
  - platform: state
    entity_id: water_heater.hotwater
    attribute: operation_mode
    from: 'off'
    to: 'on'
    for: 0:01:00
  condition: []
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: The hot water has been on for a minute. Did you mean to do this?
  - service: notify.mobile_app_kens_phone
    data:
      message: The hot water has been on for one minute. Did you mean to do this?
  mode: single
- id: '1658405017694'
  alias: Study light flashed at 13:04
  description: ''
  trigger:
  - platform: time
    at: '13:02:00'
  condition:
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  action:
  - device_id: 8cf7d4c4d3cfaa116c0ca88b1f13632b
    domain: light
    entity_id: light.study_light_level_on_off
    type: flash
  - type: turn_off
    device_id: 8cf7d4c4d3cfaa116c0ca88b1f13632b
    entity_id: light.study_light_level_on_off
    domain: light
  mode: single
- id: '1664261222949'
  alias: 'Too humid in ensuite '
  description: ''
  trigger:
  - type: humidity
    platform: device
    device_id: f89b3331f8529ce7052d3a7502435e80
    entity_id: sensor.lumi_lumi_weather_humidity
    domain: sensor
    above: 75
  condition: []
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: 'Did someone just have a shower? Open the window. '
  mode: single
- id: '1664311759291'
  alias: 'Humidity ok in ensuite '
  description: ''
  trigger:
  - type: humidity
    platform: device
    device_id: f89b3331f8529ce7052d3a7502435e80
    entity_id: sensor.lumi_lumi_weather_humidity
    domain: sensor
    below: 76
  condition: []
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: It isn't as humid in the ensuite, you can close the window now
  mode: single
- id: '1666397676117'
  alias: Turn off laptop peripherals if not connected
  description: either display unavailable, or unreachable over ethernet or wifi connection
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.work_laptop_wired
    from: 'on'
    to: 'off'
    for:
      hours: 0
      minutes: 5
      seconds: 0
    enabled: false
  - platform: state
    entity_id:
    - sensor.tramexkwg_display_display_count
    to: unavailable
    for:
      hours: 0
      minutes: 5
      seconds: 0
  condition:
  - condition: state
    entity_id: binary_sensor.study_motion_iaszone
    state: 'off'
    enabled: true
  action:
  - type: turn_off
    device_id: e9453ffdcd0ebf1d4f8d3207d4244866
    entity_id: switch.laptop_charger
    domain: switch
  - type: turn_off
    device_id: e9453ffdcd0ebf1d4f8d3207d4244866
    entity_id: switch.tz3000_vmpbygs5_ts011f_ab5c4ffe_on_off_3
    domain: switch
  - type: turn_off
    device_id: e9453ffdcd0ebf1d4f8d3207d4244866
    entity_id: switch.tz3000_vmpbygs5_ts011f_ab5c4ffe_on_off_2
    domain: switch
  mode: single
- id: '1667320063920'
  alias: Turn on study light if too dark
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: sensor.study_illuminance
    below: 90
  condition:
  - condition: or
    conditions:
    - condition: state
      entity_id: binary_sensor.work_laptop
      state: 'on'
    - condition: and
      conditions:
      - condition: state
        entity_id: binary_sensor.work_laptop_wired
        state: 'on'
      - condition: not
        conditions:
        - condition: state
          entity_id: input_select.input_select_study_light_actuator
          state: door
  - condition: and
    conditions:
    - type: is_occupied
      condition: device
      device_id: eccd4be440829370bbd78ad4adfc828f
      entity_id: c29f63f421873dc7c05eb93b395434d7
      domain: binary_sensor
  action:
  - type: turn_on
    device_id: 8cf7d4c4d3cfaa116c0ca88b1f13632b
    entity_id: light.study_light_level_on_off
    domain: light
  - service: input_select.select_option
    data:
      option: other
    target:
      entity_id: input_select.input_select_study_light_actuator
  mode: single
- id: '1669051788830'
  alias: Tell Ken someone is at the door
  description: When doorbell goes off, and Ken is home...
  triggers: []
  conditions:
  - condition: zone
    entity_id: person.ken_guest
    zone: zone.home
  actions:
  - type: turn_on
    device_id: 7ab073c9430e868c28fcb943989e68d9
    entity_id: light.hall_light
    domain: light
  - data:
      message: There's somebody at the door ( {{ now().timestamp() | timestamp_custom('%a
        %d-%m-%Y %-I:%M %p') }})
    action: notify.mobile_app_kens_phone
  - data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: There's somebody at the door.
    action: notify.mobile_app_kens_phone
  - action: tts.speak
    metadata: {}
    data:
      cache: true
      media_player_entity_id: media_player.office
      message: There's somebody at the door
      options: {}
    target:
      entity_id: tts.home_assistant_cloud
  mode: single
- id: '1669239928759'
  alias: Flash front kitchen light if fridge open too long - 30s
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 1c9b5deff7163f1652f08394c454bd39
    entity_id: binary_sensor.door_fridge
    domain: binary_sensor
    for:
      hours: 0
      minutes: 0
      seconds: 40
  condition: []
  action:
  - service: scene.create
    data:
      scene_id: beforeflash
      snapshot_entities: light.front_kitchen_light
  - device_id: 3f95f5b29214187c4df9e8a746b587b0
    domain: light
    entity_id: light.front_kitchen_light
    type: flash
  - delay:
      hours: 0
      minutes: 0
      seconds: 2
      milliseconds: 0
  - device_id: 3f95f5b29214187c4df9e8a746b587b0
    domain: light
    entity_id: light.front_kitchen_light
    type: flash
  - service: scene.turn_on
    data: {}
    target:
      entity_id: scene.beforeflash
  mode: single
- id: '1669240722284'
  alias: Freezer door open too long - 30s
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: a43cb826511892354d43d4819007a957
    entity_id: binary_sensor.door_freezer
    domain: binary_sensor
    for:
      hours: 0
      minutes: 0
      seconds: 30
  condition: []
  action:
  - device_id: 3f95f5b29214187c4df9e8a746b587b0
    domain: light
    entity_id: light.front_kitchen_light
    type: flash
  - delay:
      hours: 0
      minutes: 0
      seconds: 2
      milliseconds: 0
  - device_id: 3f95f5b29214187c4df9e8a746b587b0
    domain: light
    entity_id: light.front_kitchen_light
    type: flash
  mode: single
- id: '1670067056107'
  alias: You have a visitor at the door (Ken)
  description: When doorbell goes off, and Ken is home...
  trigger: []
  condition:
  - condition: zone
    entity_id: person.ken_guest
    zone: zone.home
  action:
  - type: turn_on
    device_id: 7ab073c9430e868c28fcb943989e68d9
    entity_id: light.hall_light
    domain: light
  - service: notify.mobile_app_kens_phone
    data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: There's somebody at the door.
  mode: single
- id: '1670618184363'
  alias: Main  Bathroom light on
  description: ''
  trigger:
  - type: motion
    platform: device
    device_id: 2eaac5822bfb819f9100a655154b56cd
    entity_id: f941059e11dd2a6273fc3ad4d390fe75
    domain: binary_sensor
  condition:
  - type: is_illuminance
    condition: device
    device_id: 2eaac5822bfb819f9100a655154b56cd
    entity_id: 5466bfacdc009db6a558d186a722417d
    domain: sensor
    below: 30
  action:
  - type: turn_on
    device_id: 5cc2e0c9d816959426be82c9185a2ba8
    entity_id: light.main_bathroom
    domain: light
  mode: single
- id: '1670618327475'
  alias: 'Turn off main Bathroom light when not occupied '
  description: ''
  trigger:
  - type: not_occupied
    platform: device
    device_id: 2eaac5822bfb819f9100a655154b56cd
    entity_id: binary_sensor.mainbathroom_occupancy
    domain: binary_sensor
  condition: []
  action:
  - type: turn_off
    device_id: 5cc2e0c9d816959426be82c9185a2ba8
    entity_id: light.main_bathroom
    domain: light
  mode: single
- id: '1670797807938'
  alias: Front door opens
  description: 'Turn on Hall light when too dark and front door opens '
  trigger:
  - type: opened
    platform: device
    device_id: 07f7bfed7f847d4f7b33dd6077a2c9e8
    entity_id: binary_sensor.front_door
    domain: binary_sensor
  condition:
  - type: is_illuminance
    condition: device
    device_id: 38d387756940bbaa22259ac8279bef9c
    entity_id: sensor.hall_illuminance_seperate
    domain: sensor
    below: 4
  action:
  - type: turn_on
    device_id: 7ab073c9430e868c28fcb943989e68d9
    entity_id: light.hall_light
    domain: light
  - service: input_select.select_option
    data:
      option: Normal
    target:
      entity_id: input_select.home_mode_status
  - service: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id:
      - light.cats_room
      - light.top_landing_light
  mode: single
- id: '1671018025408'
  alias: Turn off study light if bright enough
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: sensor.study_illuminance
    above: 250
  condition:
  - condition: or
    conditions:
    - condition: state
      entity_id: binary_sensor.work_laptop
      state: 'on'
    - condition: or
      conditions:
      - condition: state
        entity_id: binary_sensor.work_laptop_wired
        state: 'on'
  action:
  - type: turn_off
    device_id: 8cf7d4c4d3cfaa116c0ca88b1f13632b
    entity_id: light.study_light_level_on_off
    domain: light
  - service: input_select.select_option
    data:
      option: other
    target:
      entity_id: input_select.input_select_study_light_actuator
  mode: single
- id: '1672691608985'
  alias: 'Bed time during Christmas '
  description: Turn off the Christmas tree and nativity lights
  trigger:
  - platform: state
    entity_id: input_select.home_mode_status
    to: Bed time
    for: 00:00:02
  condition:
  - condition: state
    entity_id: binary_sensor.christmas_time
    state: 'on'
  action:
  - type: turn_off
    device_id: c7634706e5355f60ae89b69a32e95938
    entity_id: switch.christmas_tree_lights_switch_4
    domain: switch
  - type: turn_off
    device_id: 9bd5db4e258fb399874a670f894fedfc
    entity_id: switch.nativity_light
    domain: switch
  - type: turn_off
    device_id: c7634706e5355f60ae89b69a32e95938
    entity_id: switch.christmas_tree_lights_switch_2
    domain: switch
  - type: turn_off
    device_id: c7634706e5355f60ae89b69a32e95938
    entity_id: switch.christmas_tree_lights_switch_3
    domain: switch
  mode: single
- id: '1672782475912'
  alias: Christmas lights on at 4pm
  description: ''
  trigger:
  - platform: time
    at: '16:00:00'
  condition:
  - condition: state
    entity_id: binary_sensor.christmas_time
    state: 'on'
  action:
  - type: turn_on
    device_id: 9bd5db4e258fb399874a670f894fedfc
    entity_id: switch.nativity_light
    domain: switch
  - type: turn_on
    device_id: c7634706e5355f60ae89b69a32e95938
    entity_id: switch.christmas_tree_lights_switch_2
    domain: switch
  - type: turn_on
    device_id: c7634706e5355f60ae89b69a32e95938
    entity_id: switch.christmas_tree_lights_switch_3
    domain: switch
  - type: turn_on
    device_id: c7634706e5355f60ae89b69a32e95938
    entity_id: switch.christmas_tree_lights_switch_4
    domain: switch
  mode: single
- id: '1673133775025'
  alias: TV timer finishes
  description: ''
  trigger:
  - platform: event
    event_type: timer.finished
    event_data:
      entity_id: timer.tv_timer
  condition: []
  action:
  - type: turn_off
    device_id: 45edff43ad45570ac0e014272b085396
    entity_id: switch.tv
    domain: switch
  mode: single
- id: '1673303439347'
  alias: Study climate off
  description: Turn off climate control in study when occupancy clears
  triggers:
  - entity_id:
    - binary_sensor.study_occupancy
    from: 'on'
    to: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 10
    trigger: state
  conditions:
  - condition: time
    before: '18:00:00'
  actions:
  - data: {}
    target:
      entity_id: climate.study
    action: climate.turn_off
  mode: single
- id: '1674073261336'
  alias: Floodlight on when patio door opens at night time
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 478dbbf6370d0f5d8b5d63c43534298d
    entity_id: binary_sensor.patio_door
    domain: binary_sensor
  condition:
  - condition: state
    entity_id: sun.sun
    state: below_horizon
    for:
      hours: 0
      minutes: 5
      seconds: 0
  action:
  - type: turn_on
    device_id: ad5d1fee89697033117094acb0072d4d
    entity_id: light.garden_floodlight
    domain: light
  mode: single
- id: '1674760833235'
  alias: Patio door closes - floodlight off
  description: ''
  trigger:
  - type: not_opened
    platform: device
    device_id: 478dbbf6370d0f5d8b5d63c43534298d
    entity_id: binary_sensor.patio_door
    domain: binary_sensor
  condition:
  - condition: state
    entity_id: light.garden_floodlight
    state: 'on'
  action:
  - type: turn_off
    device_id: ad5d1fee89697033117094acb0072d4d
    entity_id: light.garden_floodlight
    domain: light
  mode: single
- id: '1674774776841'
  alias: Pause sonos study speaker when occupied and Ken's phone rings or meeting
    starts
  description: ''
  triggers:
  - entity_id:
    - sensor.kens_phone_audio_mode
    to: ringing
    for:
      hours: 0
      minutes: 0
      seconds: 2
    trigger: state
  - entity_id:
    - binary_sensor.tramexkwg_meeting
    to: 'on'
    trigger: state
  - trigger: state
    entity_id:
    - input_boolean.ken_in_meeting
    to: 'on'
  conditions:
  - condition: state
    entity_id: binary_sensor.study_occupancy
    state: 'on'
  - condition: state
    entity_id: media_player.office
    state: playing
  actions:
  - data: {}
    target:
      entity_id: media_player.office
    action: media_player.media_pause
  - data: {}
    target:
      entity_id: input_boolean.ken_s_phone_paused_study_speaker
    action: input_boolean.turn_on
  mode: single
- id: '1674949388037'
  alias: 'TV: Turn off after 1 hour of nothing being cast to it'
  description: ''
  triggers:
  - entity_id:
    - media_player.tv
    to: 'off'
    for:
      hours: 1
      minutes: 0
      seconds: 0
    trigger: state
  conditions: []
  actions:
  - type: turn_off
    device_id: 45edff43ad45570ac0e014272b085396
    entity_id: switch.tv
    domain: switch
  mode: single
- id: '1675075601504'
  alias: Resume sonos play in study after phone call or meeting
  description: ''
  triggers:
  - entity_id:
    - sensor.kens_phone_audio_mode
    to: normal
    for:
      hours: 0
      minutes: 0
      seconds: 2
    trigger: state
  - entity_id:
    - binary_sensor.tramexkwg_meeting
    to: 'off'
    trigger: state
  - trigger: state
    entity_id:
    - input_boolean.ken_in_meeting
    to: 'off'
  conditions:
  - condition: state
    entity_id: binary_sensor.study_occupancy
    state: 'on'
  - condition: state
    entity_id: input_boolean.ken_s_phone_paused_study_speaker
    state: 'on'
  actions:
  - data: {}
    target:
      device_id: 04709d026c7d06327bb9f6c6ce0bf98d
    action: media_player.media_play
  - data: {}
    target:
      entity_id: input_boolean.ken_s_phone_paused_study_speaker
    action: input_boolean.turn_off
  mode: single
- id: '1676397603461'
  alias: 'Guest Bedroom light on if dark and occupied '
  description: ''
  trigger:
  - type: occupied
    platform: device
    device_id: 520fa39ae9fcff5772ea371865e4975b
    entity_id: binary_sensor.guest_bedroom_occupancy
    domain: binary_sensor
  condition:
  - type: is_illuminance
    condition: device
    device_id: 520fa39ae9fcff5772ea371865e4975b
    entity_id: sensor.lumi_lumi_sensor_motion_aq2_illuminance_2
    domain: sensor
    below: 30
  action:
  - type: turn_on
    device_id: 1488e909e7ade45f02d81f77eebb5721
    entity_id: light.guest_room
    domain: light
  mode: single
- id: '1676407354562'
  alias: Guest Bedroom light off
  description: ''
  trigger:
  - type: not_opened
    platform: device
    device_id: e6b24c1897da6a8079cfea21cb45fd8b
    entity_id: binary_sensor.door_guest_bedroom
    domain: binary_sensor
    for:
      hours: 0
      minutes: 1
      seconds: 0
  condition:
  - type: is_no_motion
    condition: device
    device_id: 520fa39ae9fcff5772ea371865e4975b
    entity_id: binary_sensor.guest_bedroom_iaszone
    domain: binary_sensor
    for:
      hours: 0
      minutes: 1
      seconds: 0
  - condition: and
    conditions:
    - condition: state
      entity_id: switch.guestbedroom_extension
      state: 'off'
  action:
  - type: turn_off
    device_id: 1488e909e7ade45f02d81f77eebb5721
    entity_id: light.guest_room
    domain: light
  mode: single
- id: '1676652495907'
  alias: Presence simulation if away
  description: ''
  trigger:
  - platform: sun
    event: sunset
    offset: 0
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: person.ken_guest
      state: not_home
    - condition: state
      state: not_home
      entity_id: person.aisling
  action:
  - service: presence_simulation.start
    data: {}
  mode: single
- id: '1677227376137'
  alias: Turn on light in study if motion detected
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.study_motion_iaszone
    to: 'on'
  condition:
  - condition: numeric_state
    entity_id: sensor.study_illuminance
    below: 40
  action:
  - type: turn_on
    device_id: 8cf7d4c4d3cfaa116c0ca88b1f13632b
    entity_id: light.study_light_level_on_off
    domain: light
  mode: single
- id: '1677777185547'
  alias: Ensuite light on if motion and it's dark
  description: ''
  trigger:
  - type: motion
    platform: device
    device_id: 0eccc2c72e6440abc90619cf8f1ac2f7
    entity_id: 2f298d4f89eb847a8c395cee1667e85a
    domain: binary_sensor
  condition:
  - type: is_illuminance
    condition: device
    device_id: 0eccc2c72e6440abc90619cf8f1ac2f7
    entity_id: 36ce3a5d7f5e4987789de24cd82ce670
    domain: sensor
    below: 45
  action:
  - service: light.turn_on
    target:
      entity_id: light.ensuite
    data: {}
  mode: single
- id: '1677799425618'
  alias: Ken's light on when alarm goes off
  description: ''
  triggers:
  - entity_id:
    - sensor.kens_alarm
    to: 'True'
    trigger: state
  conditions:
  - condition: state
    entity_id: person.ken_guest
    state: home
  - condition: numeric_state
    entity_id: counter.ken_daily_alarm_count
    below: 1
  actions:
  - type: turn_on
    device_id: 93d832766c70e08420d68b48a10bb53b
    entity_id: light.lightken_level_light_color_on_off
    domain: light
  - data: {}
    target:
      entity_id: counter.ken_daily_alarm_count
    action: counter.increment
  mode: single
- id: '1679434121411'
  alias: 'Announce: Tell Aisling bus stop is coming up'
  description: ''
  trigger:
  - platform: zone
    entity_id: person.aisling
    zone: zone.almost_dorset_street
    event: enter
  condition: []
  action:
  - service: notify.mobile_app_aisling_s_phone
    data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: Your bus stop on Dorset Street is coming up
    enabled: false
  - service: notify.mobile_app_kens_phone
    data:
      message: 'Bus is coming up to Dorset Street '
  mode: single
- id: '1679985274229'
  alias: Study occupied - turn on desk and reset speaker volume
  description: Turn on everything at desk, set sonos to 10% volume
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.study_occupancy
    to: 'on'
  condition:
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  - condition: numeric_state
    entity_id: counter.study_desk_extension_lead_usage
    below: 1
  - condition: time
    after: 07:00:00
  action:
  - type: turn_on
    device_id: e9453ffdcd0ebf1d4f8d3207d4244866
    entity_id: switch.laptop_charger
    domain: switch
  - type: turn_on
    device_id: e9453ffdcd0ebf1d4f8d3207d4244866
    entity_id: switch.tz3000_vmpbygs5_ts011f_ab5c4ffe_on_off_3
    domain: switch
  - type: turn_on
    device_id: e9453ffdcd0ebf1d4f8d3207d4244866
    entity_id: switch.tz3000_vmpbygs5_ts011f_ab5c4ffe_on_off_2
    domain: switch
  - data: {}
    target:
      entity_id: switch.waketramexkwg
    action: switch.turn_on
  - data: {}
    target:
      entity_id: counter.study_desk_extension_lead_usage
    action: counter.increment
  - metadata: {}
    data:
      volume_level: 0.1
    target:
      entity_id: media_player.office
    action: media_player.volume_set
  mode: single
- id: '1680562552406'
  alias: Alert me if living room door opened when both away
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: daac5fc4ff17348df26ff34fbd47b9f9
    entity_id: binary_sensor.lumi_lumi_sensor_magnet_aq2_e1b7e401_on_off
    domain: binary_sensor
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: person.ken_guest
      state: not_home
    - condition: state
      state: not_home
      entity_id: person.aisling
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: Living room door opened
  mode: single
- id: '1680562692631'
  alias: Alert if bedroom door opened and both away
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 3a16a30d024926e21f850edf9dfa7daf
    entity_id: binary_sensor.lumi_lumi_sensor_magnet_aq2_4bd3e401_on_off
    domain: binary_sensor
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: person.ken_guest
      state: not_home
    - condition: state
      state: not_home
      entity_id: person.aisling
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: Bedroom door opened
  mode: single
- id: '1680562861571'
  alias: Alert if study door opened and away
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 722b620d26bd7ce8a669d56d9f43ba0a
    entity_id: binary_sensor.lumi_lumi_sensor_magnet_aq2_on_off
    domain: binary_sensor
  condition:
  - condition: not
    conditions:
    - condition: zone
      entity_id: person.aisling
      zone: zone.home
    - condition: and
      conditions:
      - condition: zone
        entity_id: person.ken_guest
        zone: zone.home
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: Study door opened
  mode: single
- id: '1680562891003'
  alias: Alert if guest bedroom door opened and away
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: e6b24c1897da6a8079cfea21cb45fd8b
    entity_id: binary_sensor.door_guest_bedroom
    domain: binary_sensor
  condition:
  - condition: not
    conditions:
    - condition: zone
      entity_id: person.aisling
      zone: zone.home
    - condition: and
      conditions:
      - condition: zone
        entity_id: person.ken_guest
        zone: zone.home
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: Guest bedroom door opened
  mode: single
- id: '1682522488675'
  alias: When Kettle Timer Finishes
  description: Turn off the kettle
  trigger:
  - platform: event
    event_type: timer.finished
    event_data:
      entity_id: timer.kettle_timer
  condition: []
  action:
  - type: turn_off
    device_id: b846ad89f41bd9f920420f54ebbb49c6
    entity_id: switch.tz3000_00mk2xzy_ts011f_on_off
    domain: switch
  mode: single
- id: '1683052934278'
  alias: Aisling is almost home
  description: ''
  trigger:
  - platform: zone
    entity_id: person.aisling
    zone: zone.fooo
    event: enter
  condition:
  - condition: state
    entity_id: sensor.lothlorien_aisling_s_phone_direction_of_travel
    state: towards
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: 'Aisling is almost home. Pop up to the bus stop? '
  - service: notify.mobile_app_kens_phone
    data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: Aisling is almost at the bus stop
  mode: single
- id: '1683053983671'
  alias: 'Announce: Aisling almost home'
  description: Say to go to bus stop
  trigger: []
  condition:
  - condition: state
    entity_id: input_select.voice_announcements_status
    state: Enabled
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: Aisling is almost at the bus stop
  mode: single
- id: '1685613046656'
  alias: 'Announce: Freezer door open for two minutes'
  description: ''
  trigger: []
  condition: []
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: The freezer door has been open for two minutes. Please check everything
          is ok.
  - service: media_player.play_media
    target:
      entity_id: media_player.office
    data:
      media_content_id: media-source://tts/google_translate?message=The+freezer+door+has+been+open+for+two+minutes.+Please+check+everything+is+ok.
      media_content_type: provider
    metadata:
      title: The freezer door has been open for two minutes. Please check everything
        is ok.
      thumbnail: https://brands.home-assistant.io/_/google_translate/logo.png
      media_class: app
      children_media_class:
      navigateIds:
      - {}
      - media_content_type: app
        media_content_id: media-source://tts
      - media_content_type: provider
        media_content_id: media-source://tts/google_translate?message=The+freezer+door+has+been+open+for+two+minutes.+Please+check+everything+is+ok.
  mode: single
- id: '1685613184334'
  alias: Freezer open for two minutes
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: a43cb826511892354d43d4819007a957
    entity_id: binary_sensor.door_freezer
    domain: binary_sensor
    for:
      hours: 0
      minutes: 2
      seconds: 0
  condition: []
  action:
  - service: automation.trigger
    data:
      skip_condition: false
    target:
      entity_id: automation.announce_freezer_door_open_for_two_minutes
  mode: single
- id: '1686523697673'
  alias: 'Announce: Fridge door open for two minutes'
  description: ''
  trigger: []
  condition: []
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: The fridge door has been open for two minutes. Please check everything
          is ok. Repeat. The fridge door has been open for two minutes.
  - service: media_player.play_media
    target:
      entity_id: media_player.office
    data:
      media_content_id: media-source://tts/google_translate?message=The+fridge+door+has+been+open+for+two+minutes.+Please+check+everything+is+ok.+Repeat%3A+The+fridge+door+has+been+open+for+two+minutes.
      media_content_type: provider
    metadata:
      title: 'The fridge door has been open for two minutes. Please check everything
        is ok. Repeat: The fridge door has been open for two minutes.'
      thumbnail: https://brands.home-assistant.io/_/google_translate/logo.png
      media_class: app
      children_media_class:
      navigateIds:
      - {}
      - media_content_type: app
        media_content_id: media-source://tts
      - media_content_type: provider
        media_content_id: media-source://tts/google_translate?message=The+fridge+door+has+been+open+for+two+minutes.+Please+check+everything+is+ok.+Repeat%3A+The+fridge+door+has+been+open+for+two+minutes.
  mode: single
- id: '1686523802904'
  alias: Fridge door open for two minutes
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 1c9b5deff7163f1652f08394c454bd39
    entity_id: binary_sensor.door_fridge
    domain: binary_sensor
    for:
      hours: 0
      minutes: 2
      seconds: 0
  condition: []
  action:
  - service: automation.trigger
    data:
      skip_condition: false
    target:
      entity_id: automation.announce_fridge_door_open_for_two_minutes
  mode: single
- id: '1686690807109'
  alias: Fan timer finished
  description: Turn off fan
  trigger:
  - platform: event
    event_type: timer.finished
    event_data:
      entity_id: timer.fan_timer
  condition: []
  action:
  - type: turn_off
    device_id: 45edff43ad45570ac0e014272b085396
    entity_id: switch.tz3000_vmpbygs5_ts011f_switch
    domain: switch
  mode: single
- id: '1689103934420'
  alias: 'Ken''s phone at less than 20 charge '
  description: ''
  trigger:
  - type: battery_level
    platform: device
    device_id: fe114b7e26e0d6991f2bf36f636ff679
    entity_id: edeaf026abf449ed39d80b0dc56f235b
    domain: sensor
    below: 20
  condition: []
  action:
  - data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: Charge your phone, Ken
    action: notify.mobile_app_kens_phone
  mode: single
- id: '1689666979853'
  alias: Guest room extension lead on if workday and occupied
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.guest_bedroom_occupancy
    to: 'on'
  condition:
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  - condition: zone
    entity_id: person.aisling
    zone: zone.home
  - condition: time
    before: '17:50:00'
  - condition: numeric_state
    entity_id: counter.guest_bedroom_extension_lead_usage
    below: 1
  action:
  - service: switch.turn_on
    data: {}
    target:
      entity_id: switch.guestbedroom_extension
  - service: counter.increment
    data: {}
    target:
      entity_id: counter.guest_bedroom_extension_lead_usage
  mode: single
- id: '1691184224128'
  alias: Front door light on when door opens after sunset
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.front_door
    to: 'on'
  condition:
  - condition: sun
    after: sunset
    after_offset: 00:15:00
  action:
  - service: light.turn_on
    data: {}
    target:
      entity_id: light.front_door_light
  mode: single
- id: '1691232092551'
  alias: 'Turn front door light off after sun has risen '
  description: ''
  trigger:
  - platform: sun
    event: sunrise
    offset: 06:00:00
  condition: []
  action:
  - service: light.turn_off
    data: {}
    target:
      device_id: ceda6cf8d80a88e744435ae9462ba04e
  mode: single
- id: '1692048407923'
  alias: Turn off guest bedroom extension at 6:30pm
  description: This only happens on work days.
  trigger:
  - platform: time
    at: '18:30:00'
  condition:
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  - condition: state
    entity_id: switch.guestbedroom_extension
    state: 'on'
  action:
  - service: switch.turn_off
    data: {}
    target:
      entity_id: switch.guestbedroom_extension
  mode: single
- id: '1692049755978'
  alias: Turn off front door light if on for 4 mins
  description: ''
  trigger:
  - platform: device
    type: turned_on
    device_id: ceda6cf8d80a88e744435ae9462ba04e
    entity_id: 4e04934d1f2498e3be2792a2d5c6003d
    domain: light
    for:
      hours: 0
      minutes: 6
      seconds: 0
  condition: []
  action:
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.front_door_light
  mode: single
- id: '1692391817774'
  alias: Study unoccupied, turn off light
  description: Turn off light in study if unoccupied for 30 minutes
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.study_occupancy
    to: 'off'
    for:
      hours: 0
      minutes: 30
      seconds: 0
  condition: []
  action:
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.study_light_level_on_off
  mode: single
- id: '1693209649511'
  alias: Turn off our bedside lights when we're both away
  description: ''
  trigger:
  - platform: zone
    entity_id: person.aisling
    zone: zone.home
    event: leave
  - platform: zone
    entity_id: person.ken_guest
    zone: zone.home
    event: leave
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: person.ken_guest
      state: not_home
    - condition: state
      state: not_home
      entity_id: person.aisling
  action:
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.bedside_lamps
  mode: single
- id: '1693261429977'
  alias: 'Turn off Ken''s bedside lamp if he''s asleep '
  description: ''
  trigger:
  - type: value
    platform: device
    device_id: fe114b7e26e0d6991f2bf36f636ff679
    entity_id: 044c04f40f4f48384c2663578928f207
    domain: sensor
    above: 80
  condition:
  - condition: time
    after: '22:00:00'
  - condition: state
    entity_id: light.lightken_level_light_color_on_off
    state: 'on'
  - condition: state
    entity_id: person.ken_guest
    state: home
  action:
  - data: {}
    target:
      entity_id: light.lightken_level_light_color_on_off
    action: light.turn_off
  mode: single
- id: '1693261461690'
  alias: 'Turn off Aisling''s bedside lamp if she''s asleep '
  description: ''
  trigger:
  - type: value
    platform: device
    device_id: 4ec017f2d2987d339789d744e565afc4
    entity_id: fbbf6be082b119b21205c44e68e48622
    domain: sensor
    above: 90
  condition:
  - condition: time
    after: '22:00:00'
  - condition: state
    entity_id: light.lightaisling_level_light_color_on_off
    state: 'on'
  - condition: state
    entity_id: person.aisling
    state: home
  action:
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.lightaisling_level_light_color_on_off
  mode: single
- id: '1693430925366'
  alias: Pause robovac when motion in kitchen
  description: ''
  trigger:
  - type: motion
    platform: device
    device_id: 29007fde37da4738c0b1e1fa0c8261ec
    entity_id: 1bb6624911cd87e26de21ff4abe292a9
    domain: binary_sensor
  condition:
  - condition: state
    entity_id: vacuum.robovac
    state: cleaning
  action:
  - service: vacuum.pause
    data: {}
    target:
      entity_id: vacuum.robovac
  - service: input_boolean.turn_on
    target:
      entity_id:
      - input_boolean.robovac_paused
    data: {}
  mode: single
- id: '1693431226038'
  alias: 'Resume robovac when kitchen is not occupied '
  description: ''
  trigger:
  - type: no_motion
    platform: device
    device_id: 29007fde37da4738c0b1e1fa0c8261ec
    entity_id: 1bb6624911cd87e26de21ff4abe292a9
    domain: binary_sensor
  condition:
  - condition: state
    entity_id: vacuum.robovac
    state: idle
  - condition: state
    entity_id: input_boolean.robovac_paused
    state: 'on'
  action:
  - service: vacuum.start
    data: {}
    target:
      entity_id: vacuum.robovac
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.robovac_paused
  mode: single
- id: '1695498076321'
  alias: Turn on lights up to the cats room when alarm disarmed
  description: This should only be on when we're away
  trigger:
  - platform: state
    entity_id:
    - sensor.kens_phone_last_notification
    to: '62-006111: disarmed using Keypad'
  condition:
  - condition: state
    entity_id: sun.sun
    state: below_horizon
    for:
      hours: 0
      minutes: 5
      seconds: 0
  - condition: state
    entity_id: person.aisling
    state: not_home
  - condition: state
    entity_id: person.ken_guest
    state: not_home
  action:
  - type: turn_on
    device_id: dad6ed559cf6187b8db1b104129fe92f
    entity_id: 4967f68fd2ca739e62b3a5a4acc8275e
    domain: light
  - type: turn_on
    device_id: 4cde3872053b4b4e470b84c28985d8f0
    entity_id: a5e0444961f2beaa1e3d7d0636c2080f
    domain: light
  - action: light.turn_on
    metadata: {}
    data: {}
  mode: single
- id: '1695498987317'
  alias: Turn off lights from cats room when alarm is armed
  description: This should only be on when we're away
  trigger:
  - platform: state
    entity_id:
    - sensor.kens_phone_last_notification
    to:
    - '62-006111: armed using Keypad'
  condition:
  - condition: state
    entity_id: sun.sun
    state: below_horizon
    for:
      hours: 0
      minutes: 5
      seconds: 0
  - condition: state
    entity_id: person.aisling
    state: not_home
  - condition: state
    entity_id: person.ken_guest
    state: not_home
  action:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id:
      - light.cats_room
      - light.top_landing_light
      - light.landing
  mode: single
- id: '1696011934557'
  alias: Turn off lights when alarm is turned on by Ken when away
  description: This should only be on when we're away
  trigger:
  - platform: state
    entity_id:
    - sensor.kens_phone_last_notification
    to:
    - '62-006111: armed by Ken Guest'
  condition:
  - condition: state
    entity_id: sun.sun
    state: below_horizon
    for:
      hours: 0
      minutes: 5
      seconds: 0
  - condition: state
    entity_id: person.aisling
    state: not_home
  - condition: state
    entity_id: person.ken_guest
    state: not_home
  action:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id:
      - light.cats_room
      - light.landing
      - light.top_landing_light
  mode: single
- id: '1696927173394'
  alias: Reset daily counters
  description: ''
  trigger:
  - platform: time
    at: 00:00:00
  condition: []
  action:
  - service: counter.reset
    data: {}
    target:
      entity_id: counter.guest_bedroom_extension_lead_usage
  - service: counter.reset
    data: {}
    target:
      entity_id: counter.study_desk_extension_lead_usage
  mode: single
- id: '1697573536387'
  alias: Notify - washing machine emptied action
  description: ''
  trigger:
  - platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: WASHING_MACHINE_EMPTIED
  condition: []
  action:
  - service: notify.mobile_app_kens_phone
    data:
      data:
        tag: washing
      message: clear_notification
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.washing_machine_emptied
  mode: single
- id: '1697578374544'
  alias: Notify - tumble dryer emptied
  description: set the tumble dryer emptied boolean to empty
  trigger:
  - platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: TUMBLE_DRYER_EMPTIED
  condition: []
  action:
  - service: notify.mobile_app_kens_phone
    data:
      data:
        tag: tumbledryer
      message: clear_notification
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id: input_boolean.tumble_dryer_emptied
  mode: single
- id: '1697578648523'
  alias: Notify - dishwasher emptied action
  description: set the dishwasher emptied boolean to empty
  trigger:
  - platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: DISHWASHER_EMPTIED
  condition: []
  action:
  - service: notify.mobile_app_kens_phone
    data:
      data:
        tag: dishwasher
      message: clear_notification
  - service: input_boolean.turn_off
    data: {}
    target:
      entity_id:
      - input_boolean.dishwasher_emptied
  mode: single
- id: '1697890916321'
  alias: 'Enable the TV off if no cast automation '
  description: ''
  trigger:
  - platform: state
    entity_id:
    - switch.tv
    to: 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 1
  condition: []
  action:
  - service: automation.turn_on
    data: {}
    target:
      entity_id: automation.tv_turn_off_after_15_mins_of_nothing_being_cast_to_it
  mode: single
- id: '1698051290023'
  alias: Reset alarm volume on Ken's phone
  description: Reset all streams to max volume
  trigger:
  - platform: time
    at: 01:00:00
  condition: []
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: command_volume_level
      data:
        media_stream: music_stream
        command: 20
  - service: notify.mobile_app_kens_phone
    data:
      message: command_volume_level
      data:
        media_stream: notification_stream
        command: 20
  - service: notify.mobile_app_kens_phone
    data:
      message: command_volume_level
      data:
        media_stream: system_stream
        command: 20
  - service: notify.mobile_app_kens_phone
    data:
      message: command_volume_level
      data:
        media_stream: alarm_stream
        command: 20
  mode: single
- id: '1698100167669'
  alias: 'Bed time when night mode set on house alarm '
  description: Only set after 9pm
  trigger:
  - platform: state
    entity_id:
    - sensor.kens_phone_last_notification
    to:
    - '62-006111: night mode activated by Ken Guest'
  condition:
  - condition: time
    after: '21:00:00'
  action:
  - delay:
      hours: 0
      minutes: 2
      seconds: 30
      milliseconds: 0
  - service: input_select.select_option
    data:
      option: Bed time
    target:
      entity_id: input_select.home_mode_status
  mode: single
- id: '1698131507925'
  alias: 'Front door open before sunrise '
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.front_door
    to: 'on'
  condition:
  - condition: sun
    before: sunrise
    before_offset: '20'
  action:
  - service: light.turn_on
    data: {}
    target:
      entity_id: light.front_door_light
  mode: single
- id: '1698882852291'
  alias: 'Ensuite light off if no motion '
  description: ''
  triggers:
  - type: no_motion
    platform: device
    device_id: 0eccc2c72e6440abc90619cf8f1ac2f7
    entity_id: 2f298d4f89eb847a8c395cee1667e85a
    domain: binary_sensor
    for:
      hours: 0
      minutes: 4
      seconds: 0
  conditions:
  - condition: not
    conditions:
    - type: is_moist
      condition: device
      device_id: e5f1c540fe7b70520f0b5b5c058d814e
      entity_id: 02d85721f07d6a6b4bf445bd72e2f0d5
      domain: binary_sensor
      enabled: true
    enabled: true
  actions:
  - data: {}
    target:
      entity_id: light.ensuite
    action: light.turn_off
  mode: single
- id: '1699145152606'
  alias: 'Front door opens, cancel presence simulation '
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 07f7bfed7f847d4f7b33dd6077a2c9e8
    entity_id: binary_sensor.front_door
    domain: binary_sensor
  condition: []
  action:
  - service: presence_simulation.stop
    data: {}
  mode: single
- id: '1699639907048'
  alias: Bedside lamps go on when we come home
  description: ''
  trigger:
  - platform: numeric_state
    entity_id:
    - sensor.lothlorien_kens_phone_distance
    below: 200
  condition:
  - condition: not
    conditions:
    - condition: zone
      entity_id: person.ken_guest
      zone: zone.home
  - condition: sun
    after: sunset
  - condition: numeric_state
    entity_id: zone.home
    above: 1
  action:
  - service: light.turn_on
    data: {}
    target:
      entity_id:
      - light.bedside_lamps
  mode: single
- id: '1700034358783'
  alias: Turn off all lights when we're away from home
  description: ''
  trigger:
  - platform: numeric_state
    entity_id:
    - zone.home
    below: 1
  condition:
  - condition: state
    entity_id: switch.presence_simulation
    state: 'off'
  action:
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.all_lights
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.ensuite
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.bedside_lamps
  mode: single
- id: '1700181554374'
  alias: Front door light on when ken comes home after dark
  description: ''
  trigger:
  - platform: numeric_state
    entity_id:
    - sensor.lothlorien_3_ken_guest_distance
    below: 300
  condition:
  - condition: not
    conditions:
    - condition: zone
      entity_id: person.ken_guest
      zone: zone.home
  - condition: sun
    after: sunset
  action:
  - service: light.turn_on
    data: {}
    target:
      entity_id:
      - light.front_door_light
  mode: single
- id: '1701206647376'
  alias: Porch light on when Aisling comes home after dark
  description: ''
  trigger:
  - platform: numeric_state
    entity_id:
    - sensor.lothlorien_aisling_s_phone_distance
    below: 200
  condition:
  - condition: not
    conditions:
    - condition: zone
      entity_id: person.aisling
      zone: zone.home
  - condition: sun
    after: sunset
  action:
  - service: light.turn_on
    data: {}
    target:
      entity_id:
      - light.front_door_light
  mode: single
- id: '1704544441733'
  alias: 'Turn on washing machine when laundry room opens '
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.door_laundry_room_on_off
    to: 'on'
  condition:
  - condition: state
    entity_id: sensor.washing_machine_status
    state: Clean
  action:
  - service: switch.turn_on
    target:
      entity_id:
      - switch.plugwashing_machine_on_off
    data: {}
  mode: single
- id: '1704545256447'
  alias: 'Turn off washing machine when door closes '
  description: But only if doing nothing
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.door_laundry_room_on_off
    to: 'off'
  condition:
  - condition: state
    entity_id: sensor.washing_machine_status
    attribute: id
    state: Clean
  action:
  - service: switch.turn_off
    target:
      entity_id:
      - switch.plugwashing_machine_on_off
    data: {}
  mode: single
- id: '1706209785675'
  alias: Cats room light on when movement on landing
  description: ''
  trigger:
  - type: motion
    platform: device
    device_id: 5cb929bb135e3cedf31510218bba30d4
    entity_id: binary_sensor.landing_sensor_ias_zone
    domain: binary_sensor
  condition:
  - condition: state
    entity_id: sun.sun
    state: below_horizon
  - condition: not
    conditions:
    - condition: zone
      entity_id: person.aisling
      zone: zone.home
    - condition: and
      conditions:
      - condition: zone
        entity_id: person.ken_guest
        zone: zone.home
  action:
  - type: turn_on
    device_id: dad6ed559cf6187b8db1b104129fe92f
    entity_id: 4967f68fd2ca739e62b3a5a4acc8275e
    domain: light
  - service: input_select.select_option
    target:
      entity_id: input_select.home_mode_status
    data:
      option: Normal
  - service: light.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: light.cats_room
  - service: light.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: light.top_landing_light
  mode: single
- id: '1706209967952'
  alias: Cats light on triggered by movement in landing
  description: ''
  trigger:
  - type: motion
    platform: device
    device_id: f8835a0621ca201abdb9634e8d71c0a7
    entity_id: binary_sensor.top_platform_ias_zone
    domain: binary_sensor
  condition:
  - condition: state
    entity_id: sun.sun
    state: below_horizon
  - condition: not
    conditions:
    - condition: zone
      entity_id: person.aisling
      zone: zone.home
    - condition: and
      conditions:
      - condition: zone
        entity_id: person.ken_guest
        zone: zone.home
  - condition: trigger
    id: ''
  action:
  - type: turn_on
    device_id: dad6ed559cf6187b8db1b104129fe92f
    entity_id: 4967f68fd2ca739e62b3a5a4acc8275e
    domain: light
    brightness_pct: 100
  - service: input_select.select_option
    target:
      entity_id: input_select.home_mode_status
    data:
      option: Normal
  - service: light.turn_on
    metadata: {}
    data: {}
    target:
      entity_id:
      - light.top_landing_light
      - light.cats_room
  mode: single
- id: '1707387055423'
  alias: Heat study on work day
  description: Turn on heater if needed
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.study_occupancy
    to: 'on'
  condition:
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  - condition: state
    entity_id: climate.upstairs
    state: 'off'
  action:
  - service: climate.turn_on
    data: {}
    target:
      entity_id: climate.study
  - service: climate.set_temperature
    metadata: {}
    data:
      temperature: 19
    target:
      entity_id: climate.study
  mode: single
- id: '1708030449892'
  alias: Aisling's meeting has finished
  description: Say as much on the study speaker
  trigger:
  - platform: state
    entity_id:
    - input_boolean.aisling_meeting
    from: 'on'
    to: 'off'
  condition: []
  action:
  - service: media_player.play_media
    target:
      entity_id: media_player.office
    data:
      media_content_id: media-source://tts/google_translate?message=Aisling%27s+meeting+has+finished+
      media_content_type: provider
    metadata:
      title: 'Aisling''s meeting has finished '
      thumbnail: https://brands.home-assistant.io/_/google_translate/logo.png
      media_class: app
      children_media_class:
      navigateIds:
      - {}
      - media_content_type: app
        media_content_id: media-source://tts
      - media_content_type: provider
        media_content_id: media-source://tts/google_translate?message=Aisling%27s+meeting+has+finished+
  mode: single
- id: '1708030597425'
  alias: 'Aisling is now in a meeting '
  description: Say as much on the study speaker
  trigger:
  - platform: state
    entity_id:
    - input_boolean.aisling_meeting
    from: 'off'
    to: 'on'
  condition: []
  action:
  - service: tts.google_translate_say
    metadata: {}
    data:
      cache: true
      entity_id: media_player.office
      message: Aisling is now in a meeting
  mode: single
- id: '1708470196781'
  alias: Reset night time pills consumed to off after 7 hours
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.night_time_pills_consumed_by_aisling
    to: 'on'
    for:
      hours: 7
      minutes: 0
      seconds: 0
  condition: []
  action:
  - service: input_boolean.turn_off
    target:
      entity_id: input_boolean.night_time_pills_consumed_by_aisling
    data: {}
  mode: single
- id: '1708470417456'
  alias: Aisling's morning time pills indicator reset to off after 7 hours
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.morning_time_pills_consumed_by_aisling
    to: 'on'
    for:
      hours: 7
      minutes: 0
      seconds: 0
  condition: []
  action:
  - service: input_boolean.turn_off
    target:
      entity_id:
      - input_boolean.morning_time_pills_consumed_by_aisling
    data: {}
  mode: single
- id: '1709113052310'
  alias: Visitor at doorbell
  description: Doorbell button has been pressed
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.doorbell_visitor
    to: 'on'
  condition: []
  action:
  - service: automation.trigger
    target:
      entity_id: automation.tell_ken_someone_is_at_the_door
    data:
      skip_condition: true
  - service: automation.trigger
    data:
      skip_condition: true
    target:
      entity_id: automation.tell_aisling_somebody_is_at_the_door
  mode: single
- id: '1709221266402'
  alias: Identify when the doorbell is working
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.doorbell_person
    from: unavailable
  condition: []
  action:
  - service: tts.google_translate_say
    metadata: {}
    data:
      cache: true
      entity_id: media_player.office
      message: doorbell is working again
  - service: notify.mobile_app_kens_phone
    data:
      message: Reolink doorbell has reconnected
  mode: single
- id: '1709321282158'
  alias: 'Identify when doorbell has disconnected '
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.doorbell_person
    to: unavailable
  condition: []
  action:
  - service: tts.google_translate_say
    metadata: {}
    data:
      cache: true
      entity_id: media_player.office
      message: 'The doorbell has disconnected from the network '
  - service: notify.mobile_app_kens_phone
    data:
      message: 'The doorbell has disconnected from the network. '
  mode: single
- id: '1709562518090'
  alias: Turn off all relevant lights when I'm in the study
  description: ''
  trigger:
  - platform: conversation
    command: I'm alone in the study
  condition: []
  action:
  - service: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id:
      - light.all_lights
  - service: light.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: light.study_light_level_on_off
  mode: single
- id: '1709710114249'
  alias: Turn off all other lights when in the study
  description: '... And only one person at home'
  triggers:
  - entity_id:
    - binary_sensor.study_motion_iaszone
    to: 'on'
    trigger: state
  conditions:
  - condition: numeric_state
    entity_id: zone.home
    below: 2
  - condition: zone
    entity_id: person.ken_guest
    zone: zone.home
  - condition: not
    conditions:
    - condition: zone
      entity_id: person.aisling
      zone: zone.home
  actions:
  - metadata: {}
    data: {}
    target:
      entity_id:
      - light.kitchen_lights
      - light.hall_light
      - light.landing
      - light.main_bathroom
      - light.ensuite
      - light.lightken_level_light_color_on_off
      - light.lightaisling_level_light_color_on_off
      - light.top_landing_light
      - light.cats_room
    action: light.turn_off
  mode: single
- id: '1711820545178'
  alias: Person near front door.
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.doorbell_person
    for:
      hours: 0
      minutes: 0
      seconds: 1
    to: 'on'
  condition: []
  action:
  - service: camera.snapshot
    metadata: {}
    data:
      filename: /config/www/images/camera-doorbell.jpg
    target:
      entity_id: camera.doorbell_fluent
  - service: notify.mobile_app_kens_phone
    metadata: {}
    data:
      message: 'Ken. There''s somebody near the front door.

        '
      title: There's someone near the front door.
      data:
        clickAction: https://85fjf9mvcjwllzibdzzx4j86n4zot5y4.ui.nabu.casa/local/images/camera-doorbell.jpg
        color: '#2D0000'
        timeout: 60
  - service: notify.mobile_app_aisling_s_phone
    data:
      data: {}
      message: Aisling! There's somebody near the front door.
      title: There's someone near the front door.
  mode: single
- id: '1712259471441'
  alias: Turn on bedside lamps when door opens and it's dark
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.lumi_lumi_sensor_magnet_aq2_4bd3e401_on_off
    to: 'on'
  condition:
  - condition: numeric_state
    entity_id: sensor.masterbedroom_illuminance
    below: 5
  - condition: state
    entity_id: sun.sun
    state: below_horizon
  action:
  - service: light.turn_on
    metadata: {}
    data: {}
    target:
      area_id: bedroom
  mode: single
- id: '1712877760848'
  alias: Porch light on after dark if person detected
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.doorbell_person
    for:
      hours: 0
      minutes: 0
      seconds: 0
    to: 'on'
  condition:
  - condition: state
    entity_id: sun.sun
    state: below_horizon
  action:
  - service: light.turn_on
    metadata: {}
    data:
      brightness_pct: 100
    target:
      entity_id: light.front_door_light
  mode: single
- id: '1713388183112'
  alias: Low battery level detection & notification for all battery sensors
  description: ''
  use_blueprint:
    path: gmlupatelli/low_battery_notification.yaml
    input:
      actions:
      - action: notify.send_message
        metadata: {}
        data:
          message: '{{sensors}} battery low'
      time: '10:10:00'
- id: '1713778858807'
  alias: Charge laptop
  description: Turn on laptop charger when battery is considered at v low charge
  trigger:
  - platform: numeric_state
    entity_id:
    - sensor.tramexkwg_tramexkwg_battery_charge_remaining_percentage
    below: 25
  condition: []
  action:
  - service: switch.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: switch.laptop_charger
  mode: single
- id: '1713778962244'
  alias: Stop charging laptop
  description: Turn on laptop charger if battery more than 90%
  trigger:
  - platform: numeric_state
    entity_id:
    - sensor.tramexkwg_tramexkwg_battery_charge_remaining_percentage
    above: 90
  condition: []
  action:
  - service: switch.turn_off
    target:
      entity_id:
      - switch.laptop_charger
    data: {}
  mode: single
- id: '1713955864568'
  alias: Tell Aisling somebody is at the door
  description: When doorbell goes off, and Aisling is home...
  trigger: []
  condition:
  - condition: zone
    entity_id: person.aisling
    zone: zone.home
  action:
  - type: turn_on
    device_id: 7ab073c9430e868c28fcb943989e68d9
    entity_id: light.hall_light
    domain: light
  - service: notify.mobile_app_aisling_s_phone
    data:
      data:
        channel: alarm_stream
        priority: high
        tts_text: There's somebody at the door.
      message: TTS
  - service: notify.mobile_app_aisling_s_phone
    data:
      message: 'Aisling, someone has pressed the doorbell. '
  mode: single
- id: '1715160459521'
  alias: Say when to empty the robovac
  description: ''
  trigger:
  - platform: numeric_state
    entity_id:
    - counter.robovac_usage
    above: 10
  condition:
  - condition: state
    entity_id: vacuum.robovac
    state: docked
    for:
      hours: 0
      minutes: 10
      seconds: 0
  action:
  - service: notify.mobile_app_kens_phone
    metadata: {}
    data:
      message: You should probably empty the robovac
  mode: single
- id: '1715207475642'
  alias: 'Turn front door light off when no person detected '
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.doorbell_person
    for:
      hours: 0
      minutes: 1
      seconds: 0
    to: 'off'
  condition:
  - condition: state
    entity_id: light.front_door_light
    state: 'on'
  action:
  - target:
      entity_id:
      - light.front_door_light
    data: {}
    action: light.turn_off
  mode: single
- id: '1715700578805'
  alias: Doorbell motion
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.doorbell_motion
    to: 'on'
    enabled: true
  - platform: state
    entity_id:
    - binary_sensor.doorbell_person
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.paranoia
    state: 'on'
  action:
  - service: media_player.play_media
    target:
      entity_id: media_player.office
    data:
      media_content_id: media-source://tts/google_translate?message=Motion+detected+outside
      media_content_type: provider
    metadata:
      title: Motion detected outside
      thumbnail: https://brands.home-assistant.io/_/google_translate/logo.png
      media_class: app
      children_media_class:
      navigateIds:
      - {}
      - media_content_type: app
        media_content_id: media-source://tts
      - media_content_type: provider
        media_content_id: media-source://tts/google_translate?message=Motion+detected+outside
  - service: notify.mobile_app_kens_phone
    data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: Motion detected outside
  mode: single
- id: '1715797209490'
  alias: Is Aisling off the phone
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.aisling_s_phone_audio_mode
    from: in_call
    to: normal
    for:
      hours: 0
      minutes: 1
      seconds: 0
  condition: []
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: 'Aisling''s off the phone '
  mode: single
- id: '1715944194502'
  alias: 'Is Aisling on the phone '
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.aisling_s_phone_audio_mode
    to: in_call
    for:
      hours: 0
      minutes: 1
      seconds: 0
  condition: []
  action:
  - service: notify.mobile_app_kens_phone
    data:
      message: 'Aisling''s on the phone '
  mode: single
- id: '1716280540589'
  alias: Activate robovac at 10am on a work day
  description: ''
  triggers:
  - at: '11:00:00'
    trigger: time
  conditions:
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  actions:
  - target:
      entity_id: vacuum.robovac
    data: {}
    action: vacuum.start
  mode: single
- id: '1716499932240'
  alias: 'Alert when litter tray needs to be emptied '
  description: ''
  trigger:
  - type: value
    platform: device
    device_id: dc09b50ee6b490b17f2f0b4a4911a45f
    entity_id: 122caa6ae8dc93e0a700358d37dde853
    domain: sensor
    above: 90
    for:
      hours: 0
      minutes: 0
      seconds: 0
  condition: []
  action:
  - data:
      message: 'Litter Robot waste tray needs to be emptied '
      data:
        persistent: true
        tag: litter_robot_waste
        actions:
        - action: LITTER_ROBOT_WASTE_EMPTIED
          title: Comfirm litter waster drawer emptird
    action: notify.mobile_app_kens_phone
  - metadata: {}
    data: {}
    target:
      entity_id: input_boolean.litter_robot_waste_drawer_emptied
    action: input_boolean.turn_on
  mode: single
- id: '1716653676139'
  alias: Reboot router if disconnected for 5 mins
  description: ''
  trigger:
  - type: not_connected
    platform: device
    device_id: d738ba5e00eff938acf38a5b81818c75
    entity_id: 34238a295cb3e9d90c7dcc6798d1ed6c
    domain: binary_sensor
    for:
      hours: 0
      minutes: 5
      seconds: 0
  condition: []
  action:
  - action: button.press
    metadata: {}
    data: {}
    target:
      entity_id: button.fritz_box_7530_reconnect_2
  - metadata: {}
    data:
      message: Router disconnected. Rebooted it
    action: notify.mobile_app_kens_phone
  mode: single
- id: '1717149233508'
  alias: Turn off presence simulation at sunrise when away
  description: ''
  trigger:
  - platform: sun
    event: sunrise
    offset: 0
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: person.ken_guest
      state: not_home
    - condition: state
      state: not_home
      entity_id: person.aisling
  action:
  - service: presence_simulation.stop
    data: {}
  mode: single
- id: '1717951292080'
  alias: 'Litter Robot : more litter '
  description: ''
  trigger:
  - platform: numeric_state
    entity_id:
    - sensor.a_l_f_litter_level
    below: 51
  condition: []
  action:
  - service: notify.mobile_app_kens_phone
    metadata: {}
    data:
      message: ALF Needs More Litter
  mode: single
- id: '1718628149308'
  alias: 'Turn on Kettle for hot water bottle (voice) '
  description: ''
  triggers:
  - command:
    - Need a Hot water bottle please
    - I need a Hot water bottle please
    - Aisling needs a hot water bottle please
    trigger: conversation
  conditions: []
  actions:
  - target:
      entity_id:
      - switch.tz3000_00mk2xzy_ts011f_on_off
    data: {}
    action: switch.turn_off
  - target:
      entity_id: automation.kettle_turn_off_after_4_minutes
    data: {}
    action: automation.turn_on
  - metadata: {}
    data: {}
    target:
      entity_id: switch.tz3000_00mk2xzy_ts011f_on_off
    action: switch.turn_on
  - set_conversation_response: Turning the kettle on for just a few minutes for a
      hot water bottle.
  mode: single
- id: '1719306409027'
  alias: Reset litter to be emptied if no where near full
  description: ''
  trigger:
  - type: value
    platform: device
    device_id: dc09b50ee6b490b17f2f0b4a4911a45f
    entity_id: 122caa6ae8dc93e0a700358d37dde853
    domain: sensor
    for:
      hours: 0
      minutes: 0
      seconds: 0
    below: 60
  condition: []
  action:
  - metadata: {}
    data: {}
    target:
      entity_id: input_boolean.litter_robot_waste_drawer_emptied
    action: input_boolean.turn_off
  mode: single
- id: '1719935345013'
  alias: Pause TV when doorbell rung
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.doorbell_visitor
    to: 'on'
  conditions:
  - condition: state
    entity_id: media_player.tv
    state: playing
  actions:
  - target:
      entity_id: media_player.tv
    data: {}
    action: media_player.media_play_pause
  mode: single
- id: '1720029388029'
  alias: 'Cloakroom door closes - toggle busy flag '
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.lumi_lumi_sensor_magnet_aq2_a9c35302_on_off
    to: 'off'
  condition: []
  action:
  - service: input_boolean.toggle
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.cloakroom_busy
  mode: single
- id: '1720029864182'
  alias: Auto turn off cloakroom light
  description: ''
  triggers:
  - entity_id:
    - input_boolean.cloakroom_busy
    to: 'off'
    trigger: state
  conditions: []
  actions:
  - metadata: {}
    data: {}
    target:
      entity_id: light.cloak_room
    action: light.turn_off
  mode: single
- id: '1720655133884'
  alias: 'Litter Robot Waste Emptied - action '
  description: ''
  trigger:
  - platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: LITTER_ROBOT_WASTE_EMPTIED
  condition: []
  action:
  - service: input_boolean.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.litter_robot_waste_drawer_emptied
  mode: single
- id: '1721228695738'
  alias: Paranoia mode on if front door open for more than 5 minutes
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.front_door
    to: 'on'
    for:
      hours: 0
      minutes: 5
      seconds: 0
  condition: []
  action:
  - service: input_boolean.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.paranoia
  mode: single
- id: '1721228770999'
  alias: Paranoia mode off if front door closed
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.front_door
    to: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 10
  condition: []
  action:
  - service: input_boolean.turn_off
    target:
      entity_id:
      - input_boolean.paranoia
    data: {}
  mode: single
- id: '1721597497936'
  alias: 'Reset Merlyn''s pill reminder. '
  description: ''
  trigger:
  - platform: time
    at: 05:59:00
  condition: []
  action:
  - service: input_boolean.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.pill_consumed_by_merlyn
  mode: single
- id: '1721604204503'
  alias: Turn light off in hall after 20 mins if before 9am
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.hall_sensor_motion
    to: 'off'
    for:
      hours: 0
      minutes: 20
      seconds: 0
  condition:
  - condition: time
    before: 09:00:00
  action:
  - type: turn_off
    device_id: 7ab073c9430e868c28fcb943989e68d9
    entity_id: light.hall_light
    domain: light
  mode: single
- id: '1721604258776'
  alias: Turn light off in hall after 20 mins if before 9am
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.hall_sensor_motion
    to: 'off'
    for:
      hours: 0
      minutes: 20
      seconds: 0
  condition:
  - condition: time
    before: 09:00:00
  action:
  - type: turn_off
    device_id: 7ab073c9430e868c28fcb943989e68d9
    entity_id: light.hall_light
    domain: light
  mode: single
- id: '1722181433356'
  alias: ALF timing at 45 mins
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.a_l_f_status_code
    to: cst
    for:
      hours: 0
      minutes: 45
      seconds: 0
  condition: []
  action:
  - metadata: {}
    data:
      message: ALF is stuck at timing for 30 minutes
    action: notify.mobile_app_kens_phone
  mode: single
- id: '1722454673252'
  alias: Activate robovac at 9pm if tv is on
  description: ''
  trigger:
  - platform: time
    at: '20:45:00'
  condition:
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  - condition: state
    entity_id: switch.tv
    state: 'on'
  action:
  - service: vacuum.start
    target:
      entity_id: vacuum.robovac
    data: {}
  mode: single
- id: '1723235165748'
  alias: Turn on dishwasher when it is closed
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.door_dishwasher_opening
    to: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 0
  condition:
  - condition: state
    entity_id: switch.switchdishwasher_on_off
    state: 'off'
  action:
  - metadata: {}
    data: {}
    target:
      entity_id: switch.switchdishwasher_on_off
    action: switch.turn_on
  mode: single
- id: '1708297533072'
  alias: Flight entry notification
  trigger:
    platform: event
    event_type: flightradar24_entry
  action:
    service: notify.mobile_app_kens_phone
    data:
      content: Flight entry of {{ trigger.event.data.callsign }} to {{ trigger.event.data.airport_destination_city
        }} [Open FlightRadar](https://www.flightradar24.com/{{ trigger.event.data.callsign
        }})
- id: '1724850980131'
  alias: 'Turn off dishwasher when opened '
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.door_dishwasher_opening
    to: 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 0
  condition:
  - condition: state
    entity_id: switch.switchdishwasher_on_off
    state: 'on'
  action:
  - action: switch.turn_off
    target:
      entity_id:
      - switch.switchdishwasher_on_off
    data: {}
  mode: single
- id: '1724946156606'
  alias: Turn on tumbledryer when its door is closed
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.tumble_dryer_door_opening
    to: 'off'
  condition: []
  action:
  - action: switch.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: switch.plugtumble_dryer_on_off
  mode: single
- id: '1725191129371'
  alias: 'Turn on washing machine when closed '
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.washing_machine_door_opening
    to: 'off'
  condition: []
  action:
  - action: switch.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: switch.plugwashing_machine_on_off
  mode: single
- id: '1725305408083'
  alias: Hall light on when leaving cloakroom if dark
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.lumi_lumi_sensor_magnet_aq2_a9c35302_on_off
    to: 'on'
  condition:
  - condition: numeric_state
    entity_id: sensor.hall_sensor_illuminance
    below: 40
  action:
  - action: light.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: light.hall_light
  mode: single
- id: '1725465469967'
  alias: Inform when Aisling close to Blanch Village
  description: ''
  trigger:
  - platform: numeric_state
    entity_id:
    - sensor.blanchardstown_village_bus_stop_aisling_distance
    for:
      hours: 0
      minutes: 0
      seconds: 0
    below: 5500
  condition:
  - condition: state
    entity_id: sensor.blanchardstown_village_bus_stop_aisling_direction_of_travel
    state: towards
  - condition: state
    entity_id: input_boolean.collect_aisling_from_blanch_village
    state: 'on'
  action:
  - action: tts.speak
    metadata: {}
    data:
      cache: true
      media_player_entity_id: media_player.office
      message: Aisling is getting close to Blanchardstown Village. Fly you fool!
    enabled: false
  - data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: Aisling's getting close to Blanch Village.
    action: notify.mobile_app_kens_phone
  mode: single
- id: '1725565921298'
  alias: Cloakroom busy flag to timeout after 30 mins
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.cloakroom_busy
    to: 'on'
    for:
      hours: 0
      minutes: 30
      seconds: 0
  condition: []
  action:
  - action: input_boolean.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.cloakroom_busy
  mode: single
- id: '1726822944274'
  alias: Play Supernatural Soundtrack on Study speaker
  description: ''
  trigger:
  - platform: conversation
    command:
    - Play the Supernatural soundtrack on the study speaker
    - Play the Supernatural soundtrack
    - Play Supernatural soundtrack
  condition: []
  action:
  - action: media_player.play_media
    target:
      entity_id:
      - media_player.office
    data:
      media_content_id: https://open.spotify.com/playlist/7EG93rnpCyxpcKQ6fazFa8
      media_content_type: playlist
  mode: single
- id: '1726843267781'
  alias: Play ACDC on the study speaker
  description: ''
  trigger:
  - platform: conversation
    command:
    - Play ACDC on the study speaker
    - Play ACDC
    - Play ACDC please
  condition: []
  action:
  - action: media_player.play_media
    target:
      entity_id:
      - media_player.office
    data:
      media_content_id: https://open.spotify.com/playlist/37i9dQZF1DZ06evO49hLQA
      media_content_type: playlist
  mode: single
- id: '1727035490180'
  alias: Turn on litter robot panel lockout if off for 30 mins
  description: ''
  trigger:
  - platform: state
    entity_id:
    - switch.a_l_f_panel_lockout
    from: 'off'
    for:
      hours: 0
      minutes: 30
      seconds: 0
  condition: []
  action:
  - action: switch.turn_on
    target:
      entity_id:
      - switch.a_l_f_panel_lockout
    data: {}
  mode: single
- id: '1728903876416'
  alias: Turn off washing machine when opened
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.washing_machine_door_opening
    to: 'on'
  conditions: []
  actions:
  - action: switch.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: switch.plugwashing_machine_on_off
  mode: single
- id: '1729599157246'
  alias: Turn off ALF panel lockout when in cats room
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.cats_occupancy
    to: 'on'
  conditions: []
  actions:
  - action: switch.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: switch.a_l_f_panel_lockout
  mode: single
- id: '1729627791896'
  alias: Top Landing light on when study door opens
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.lumi_lumi_sensor_magnet_aq2_on_off
    to: 'on'
  conditions:
  - condition: numeric_state
    entity_id: sensor.top_platform_illuminance
    below: 25
  actions:
  - action: light.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: light.top_landing_light
  mode: single
- id: '1731499339709'
  alias: 'Bathroom: Leak detected'
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.bathroom_water_detector_iaszone
    from: 'off'
    to: 'on'
  conditions: []
  actions:
  - data:
      message: TTS
      data:
        channel: alarm_stream
        priority: high
        tts_text: Leak detector in main bathroom is wet. Leak detector in main bathroom
          is wet.
    action: notify.mobile_app_kens_phone
  mode: single
- id: '1731675022203'
  alias: Turn off Aisling's electric blanket if on for two hour
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - switch.electric_blanket_aisling_switch
    to: 'on'
    for:
      hours: 2
      minutes: 0
      seconds: 0
  conditions: []
  actions:
  - action: switch.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: switch.electric_blanket_aisling_switch
  mode: single
- id: '1732126287087'
  alias: 'Turn off top Landing light '
  description: ''
  triggers:
  - type: no_motion
    device_id: 5cb929bb135e3cedf31510218bba30d4
    entity_id: binary_sensor.landing_sensor_ias_zone
    domain: binary_sensor
    trigger: device
  conditions:
  - condition: state
    entity_id: light.top_landing_light
    state: 'on'
  actions:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: light.top_landing_light
  mode: single
- id: '1732126308149'
  alias: 'Turn off top Landing light '
  description: ''
  triggers:
  - type: no_motion
    device_id: 5cb929bb135e3cedf31510218bba30d4
    entity_id: binary_sensor.landing_sensor_ias_zone
    domain: binary_sensor
    trigger: device
  conditions:
  - condition: state
    entity_id: light.top_landing_light
    state: 'on'
  actions:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: light.top_landing_light
  mode: single
- id: '1732987744754'
  alias: Turn off upstairs heating if room is too hot
  description: ''
  triggers:
  - trigger: numeric_state
    entity_id:
    - sensor.masterbedroom_temperature
    above: 19
  conditions: []
  actions:
  - action: climate.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: climate.upstairs
  mode: single
- id: '1733596262371'
  alias: Turn on Christmas tree
  description: ''
  triggers:
  - trigger: conversation
    command:
    - Light the beacons
  conditions: []
  actions:
  - set_conversation_response: Gondor calls for aid
  mode: single
- id: '1733597203894'
  alias: The beacons are lit
  description: ''
  triggers:
  - trigger: conversation
    command: The beacons are lit
  conditions: []
  actions:
  - set_conversation_response: Gondor calls for aid. And Rohan shall answer. Muster
      the rohirrim
  - action: switch.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: switch.christmas_tree_lights_switch_2
  mode: single
- id: '1733616374692'
  alias: 'Start timer to switch off Aisling''s electric blanket '
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - switch.electric_blanket_aisling_switch
    to: 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 1
  conditions: []
  actions:
  - action: timer.start
    metadata: {}
    data: {}
    target:
      entity_id: timer.electric_blanket_timer_aisling
  mode: single
- id: '1733616699128'
  alias: 'Turn off Aisling''s electric blanket when timer finishes '
  description: ''
  triggers:
  - event_type: timer.finished
    event_data:
      entity_id: timer.electric_blanket_timer_aisling
    trigger: event
  conditions:
  - condition: state
    entity_id: switch.electric_blanket_aisling_switch
    state: 'on'
  actions:
  - action: switch.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: switch.electric_blanket_aisling_switch
  mode: single
- id: '1733843204135'
  alias: New Email From Aisling
  description: ''
  triggers:
  - trigger: numeric_state
    entity_id:
    - sensor.imap_ken_guest_gmail_com_messages
    above: 0
  conditions: []
  actions:
  - action: tts.cloud_say
    metadata: {}
    data:
      cache: false
      message: You have new email from Aisling
      entity_id: media_player.office
  mode: single
